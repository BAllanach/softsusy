\documentclass[final,3p,times,pdflatex]{elsarticle}
\usepackage{axodraw}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{color} % LCT: for text editing
\usepackage{slashed}

\bibstyle{elsarticle-num}

% beginning of macros
\def\SOFTSUSY{{\tt SOFTSUSY}}
\def\code#1{\small{\tt #1}\normalsize}
\newcommand{\nn}{\nonumber}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\ba}{\begin{eqnarray}}
\newcommand{\ea}{\end{eqnarray}}
%\newcommand{\Zv}{{\mbox{${\not\!\!Z_3}$}}}
\newcommand{\Zv}{{\mbox{$\slashed{Z}_{3}$}}} % LCT: Better placement of \
\newcommand{\ds}{\displaystyle}
% for RGEs
\newcommand{\lamsq}{\lambda^2}
\newcommand{\kapsq}{\kappa^2}
\newcommand{\tr}{\mathrm{Tr}}
\newcommand{\dt}{\frac{d}{dt}}
\newcommand{\mhusq}{m^2_{H_2}}
\newcommand{\mhdsq}{m^2_{H_1}}
\newcommand{\mlamsq}{M_\lambda^2}
\newcommand{\mkapsq}{M_\kappa^2}
\newcommand{\mssq}{m_S^2}
\newcommand{\mtrisq}{m_3^2}
\newcommand{\msprsq}{m_S'^2}
\newcommand{\mqsq}{m_{\tilde{Q}}^2}
\newcommand{\mdsq}{m_{\tilde{d}}^2}
\newcommand{\musq}{m_{\tilde{u}}^2}
\newcommand{\mlsq}{m_{\tilde{L}}^2}
\newcommand{\mesq}{m_{\tilde{e}}^2}
\newcommand{\Alam}{a_\lambda/\lambda}
\newcommand{\Akap}{a_\kappa/\kappa}
\newcommand{\Musq}{M_u^2}
\newcommand{\Mdsq}{M_d^2}
\newcommand{\Mesq}{M_e^2}
% text editing
\newcommand*{\red}[1]{\textcolor{red}{#1}}
\def\at{\alpha_t}
\def\ab{\alpha_b}
\def\as{\alpha_s}
\def\atau{\alpha_{\tau}}
\def\oat{{\cal O}(\at)}
\def\oab{{\cal O}(\ab)}
\def\oatau{{\cal O}(\atau)}
\def\oatab{{\cal O}(\at\ab)}
\def\oatas{{\cal O}(\at\as)}
\def\oabas{{\cal O}(\ab\as)}
\def\oatababq{{\cal O}(\at\ab + \ab^2)}
\def\oatqatababq{{\cal O}(\at^2 + \at\ab + \ab^2)}
\def\oatasatq{{\cal O}(\at\as + \at^2)}
\def\oatasabas{{\cal O}(\at\as +\ab\as)}
\def\oatasabasatq{{\cal O}(\at\as + \at^2 +\ab\as)}
\def\oatq{{\cal O}(\at^2)}
\def\oabq{{\cal O}(\ab^2)}
\def\oatauq{{\cal O}(\atau^2)}
\def\oabatau{{\cal O}(\ab \atau)}
\def\oas{{\cal O}(\as)}
\def\oatauqatab{{\cal O}(\atau^2 +\ab \atau )}
% end of macros

\journal{Computer Physics Communications}

\begin{document}

\begin{frontmatter}

\title{Next-to-Minimal SOFTSUSY}

\author{B.C.~Allanach}
\address{DAMTP, CMS, University of Cambridge, Wilberforce road, Cambridge, CB3
  0WA, United Kingdom}

\author{P.~Athron}
\author{Lewis~C.~Tunstall}
\author{A.G.~Williams}
\address{ARC Centre of Excellence for Particle Physics at 
the Tera-scale, School of Chemistry and Physics, University of Adelaide, 
Adelaide SA 5005 Australia}

\author{A.~Voigt}
\address{Institut f\"ur Kern- und Teilchenphysik,
TU Dresden, Zellescher Weg 19, 01069 Dresden, Germany}
\begin{abstract}
  Here, we describe an extension to the
  {\tt SOFTSUSY}~program to calculate the sparticle spectrum in the
  {\em next-to-minimal} supersymmetric standard model, where a chiral
  superfield that is a singlet of the Standard Model gauge group is added to
  the minimal supersymmetric standard model fields. 
  The user provides a theoretical boundary condition upon the couplings and
  masses of the singlet.
  Successful radiative electroweak symmetry breaking,
  electroweak and CKM matrix data are used
  as weak-scale boundary conditions. 
  The renormalisation group equations are solved
  numerically between the weak scale and a high energy scale using a nested
  iterative algorithm. 
  This paper serves as a manual to the
  next-to-minimal mode of the program, detailing the approximations and
  conventions used. 
\end{abstract}

\begin{keyword}
sparticle, 
NMSSM, Higgs
\PACS 12.60.Jv
\PACS 14.80.Ly
\end{keyword}
\end{frontmatter}

\section{Program Summary}
\noindent{\em Program title:} \SOFTSUSY{}\\
{\em Program obtainable
  from:} {\tt http://projects.hepforge.org/softsusy/}\\
{\em Distribution format:}\/ tar.gz\\
{\em Programming language:} {\tt C++}, {\tt fortran}\\
{\em Computer:}\/ Personal computer\\
{\em Operating system:}\/ Tested on Linux 4.x\\
{\em Word size:}\/ 32 bits\\
{\em External routines:}\/ None\\
{\em Typical running time:}\/ a few seconds per parameter point.\\
{\em Nature of problem:}\/ Calculating supersymmetric particle spectrum and
mixing parameters in the next-to-minimal minimal supersymmetric standard
model. The solution to the renormalisation group equations must be consistent
with boundary conditions on supersymmetry breaking parameters, as
well as a weak-scale boundary condition on gauge 
couplings, Yukawa couplings and the Higgs potential parameters.\\
{\em Solution method:}\/ Nested iterative algorithm and numerical minimisation
of the Higgs potential. \\
{\em Restrictions:} {\SOFTSUSY} will provide a solution only in the
perturbative r\'{e}gime and it
assumes that all couplings of the model are real
(i.e.\ $CP-$conserving). The iterative \SOFTSUSY~algorithm will not 
converge if parameters are too close to a boundary of successful electroweak
symmetry breaking, but a warning flag will alert the user to this fact.

\newpage

\section{Introduction}

Recently, an apparently Standard Model Higgs boson was discovered in the CMS
and ATLAS experiments at over the 5$-\sigma$ level~\cite{}. 

\section{NMSSM Parameters \label{sec:notation}}

In this section, we introduce the NMSSM parameters
in the \SOFTSUSY~conventions. The translations to the actual variable
names that are being used in the program code are shown explicitly in
~\ref{sec:objects}. 



\subsection{Supersymmetric parameters \label{susypars}}
The chiral superfield particle content of the NMSSM has the 
following $SU(3)_c\times SU(2)_L\times U(1)_Y$ quantum numbers:
\begin{eqnarray}
\hat{L}:&(1,2,-\frac{1}{2}),\quad \hat{{\overline E}}:&(1,1,1),\qquad\, \hat{Q}:\,(3,2,\frac{1}{6}),\quad
\hat{{\overline U}}:\,(\overline 3,1,-\frac{2}{3}),\nonumber\\ \hat{{\overline D}}:&(\overline 3,1,\frac{1}{3}),\quad
\hat{H}_1:&(1,2,-\frac{1}{2}),\quad \hat{H}_2:\,(1,2,\frac{1}{2}),\quad \hat{S}:\,(1,1,0)
\label{fields}
\end{eqnarray}
$\hat S$ is the Higgs singlet that is particular to the NMSSM.
$\hat L$, $\hat Q$, $\hat H_1$, and $\hat H_2$ are the left handed doublet lepton and
quark superfields and the two Higgs doublets. $\hat{\overline E}$, $\hat{\overline U}$, and
$\hat{\overline D}$ are the lepton, up-type quark and down-type quark
right-handed superfield singlets, respectively. 
Note that the lepton
doublet superfields $\hat{L}^a_i$ and the Higgs doublet superfield coupling
to the down-type quarks, $\hat{H}_1$, have the same SM gauge 
quantum numbers. 
Here, we denote an $SU(3)$ colour index of the fundamental
representation by  $\{x,y,z\} \in \{1,2,3 \}$. The $SU(2)_L$ fundamental
representation indices are denoted by $\{a,b,c\} \in \{1,2\}$ and the generation
indices by $\{i,j,k\} \in \{1,2,3\}$. 
$\epsilon_{xyz}=\epsilon^{xyz}$ and  $\epsilon_{ab}=\epsilon^{ab}$ are totally
antisymmetric tensors, with $\epsilon_{123}=1$ and $\epsilon_{12}=1$,
respectively.  Currently, only real couplings in the superpotential and Lagrangian are included. 

The full renormalisable, $R-$parity conserving superpotential is given by,
\ba 
 W_{\Zv}  &=&  \epsilon_{ab} \left[ (Y_E)_{ij} \hat L_i^b
\hat H_1^a \hat{\overline E}_j + (Y_D)_{ij} \hat Q_i^{bx} \hat H_1^a \hat{\overline D}_{jx} +
(Y_U)_{ij} \hat Q_i^{ax} \hat H_2^b \hat{\overline U}_{jx} 
+(\lambda \hat{S} + \mu)(\hat{H}^a_2 \hat{H}^b_1) \right ] +\frac{1}{3}\kappa\hat{S}^3 + \zeta_F\hat{S} + \frac{1}{2} \mu^\prime\hat{S}^2 \\
 &=& W_{MSSM}^{\mu =0}  +  \epsilon_{ab}\left [(\lambda \hat{S} + \mu)(\hat{H}^a_2 \hat{H}^b_1) \right ]+\frac{1}{3}\kappa\hat{S}^3 + \zeta_F\hat{S} + \frac{1}{2} \mu^\prime\hat{S}^2. 
\label{eq:WZ3V}
\ea
 
\noindent where we have used the subscript \Zv to reflect that this superpotential contains terms which violate the $Z_3$ symmetry which is imposed on the NMSSM in it's most common form.  Imposing the $Z_3$ symmetry restricts the superpotential to,

\ba 
 W_{Z_3} &=& \epsilon_{ab} \left[ (Y_E)_{ij} \hat L_i^b
\hat H_1^a \hat{\overline E}_j + (Y_D)_{ij} \hat Q_i^{bx} \hat H_1^a \hat{\overline D}_{jx} +
(Y_U)_{ij} \hat Q_i^{ax} \hat H_2^b \hat{\overline U}_{jx}  
+\lambda \hat{S}(\hat{H}^a_2 \hat{H}^b_1) \right ]+\frac{1}{3}\kappa\hat{S}^3 \\
 &=& W_{MSSM}^{\mu =0}  + \epsilon_{ab} \lambda \hat{S} (\hat{H}^a_2 \hat{H}^b_1) +\frac{1}{3}\kappa\hat{S}^3.
\label{eq:WZ3C}
\ea


\noindent The $Z_3$ NMSSM superpotential contains no explicit mass parameter, thereby allowing a solution to the $\mu$-problem when the singlet field picks up a VEV and generates an effective $\mu$ term of the right size.   As such it is sometimes referred to as the scale invariant NMSSM in the literature.  Here we will always write $Z_3$-NMSSM for the $Z_3$ conserving case and \Zv-NMSSM for the general $Z_3$ violating one. 


\subsection{Next-to-Minimal SUSY breaking parameters \label{sec:susybreak}}
The soft breaking scalar potential is given by,

\be V_{soft} = V_3 + V^{m_3^2 = 0}_2 + m_S^2|S|^2 + \epsilon_{ab} a_\lambda S H^a_2 H^b_1 + \frac{1}{3} a_\kappa S^3 + V_\Zv \ee where all \Zv terms are included in,
\ba V_\Zv & = & \frac{1}{2}m_S^{\prime \, 2} S^2 + \xi_S S + \epsilon_{ab} m_3^2 H_2^a H_1^b + \textrm{H.c.} \ea while $V_3$ and $V_2$ are the trilinear scalar interaction potential and scalar bilinear SUSY breaking potential of the MSSM, given in the original SOFTSUSY manual for the $R$-parity conserving MSSM\cite{Allanach:2001kg}.   The superscript on $V^{m_3^2 = 0}_2$ indicates that the \Zv soft bilinear mass $m_3^2$ present in $V_2$ is set to zero so that it is not double counted. 

%% \be V_{soft} = V_3 + V_2 + V_\Zv \ee where
%% \ba V_3 & = & V^{MSSM}_3 + \epsilon_{ab} a_\lambda S H^a_2 H^b_1 + \frac{1}{3} a_\kappa S^3 \\
%% V_2  & = & V^{MSSM}_2 + m_S^2|S|^2  \\
%% V_\Zv & = & \frac{1}{2}m_S^{\prime \, 2} S^2 + \xi_S S + \textrm{H.c.} \ea
%% \noindent and in the case of $Z_3$ conservation the soft potential reduces to,
%% \be V_{soft} = V_3 + V^{m_3^2 = 0}_2 \ee with the superscript indicationg that the \Zv soft bilinear mass $m_3^2$ present in $V^{MSSM}_2$ is set to zero.    

\subsection{Higgs potential and EWSB\label{sec:hpot}}
The tree level Higgs potential is given by,
\ba V_{Higgs} & = & V^H_F + V^H_D + V_{\rm soft}^H  \\
            & = & V^{\mu=0}_{MSSM} + V^{HN}_{F} + V_{\rm soft}^{HN}\ea where 
\ba  V^{HN}_{F} & = &  |\lambda S + \mu|^2 (|H_2|^2+|H_1|^2) + |\lambda H_2H_1
+\kappa S^2 + \mu^\prime S + \xi_S|^2  , \label{eq:HpotF} \\
 V_{\rm soft}^{HN}  & = &  m_S^2|S|^2
+ [\lambda A_{\lambda}SH_2H_1+\frac{1}{3}\kappa A_{\kappa}S^3+ \ds\frac{1}{2}m_S^{\prime \, 2} S^2 + \xi_S S + \textrm{H.c.} ], 
\label{eq:HpotS} \ea

The three neutral Higgs fields then pick up vacuum expectation values,  
\be 
        \langle H_1 \rangle = \ds\frac{1}{\sqrt{2}}{v_1 \choose 0}, 
\qquad  \langle H_2 \rangle = \ds\frac{1}{\sqrt{2}}{0 \choose v_2}, 
\qquad  \langle S \rangle =  \ds\frac{1}{\sqrt{2}}s, \label{eq:potmin} \ee
  
\noindent and the minimisation conditions relate the VEVs to the soft masses,
\ba m_{H_1}^2&=& -\frac{1}{2}M_Z^2 \cos(2\beta) - \ds\frac{1}{2}\lambda^2 v_2^2
 + (m_3^2)_\textrm{eff} \tan\beta 
- |\mu_\textrm{eff}|^2, \label{eq:mind}\\
m_{H_2}^2&=& \frac{1}{2}M_Z^2 \cos(2\beta) - \ds\frac{1}{2}\lambda^2 v_1^2 
+  \frac{(m_3^2)_\textrm{eff}}{\tan\beta} 
- |\mu_\textrm{eff}|^2 , \label{eq:minu} \\
m_S^2 &=& -\kappa^2 s^2 - \ds\frac{1}{2}\lambda^2v^2 + \kappa\lambda v_2v_1
+ \lambda A_{\lambda} \frac{v_2v_1}{\sqrt{2}s}
-\kappa A_{\kappa}s  - m^{\prime \,2}_S - \mu^{\prime \,2} + 2 \kappa \xi_F  - 3 \kappa s \mu^\prime \label{eq:mins}
\ea where $\tan \beta = v_2 /  v_1$. %% $\overline g = \sqrt{g^2+g^{\prime 2}}$ and $g$ and $g^{\prime}$
%% are the gauge couplings of $SU(2)_L$ and $U(1)$ interactions
%% respectively, with $g = g_2$ and $g^\prime = \sqrt{3/5} \, g_1$.
For simplicity we have introduced,
\be (m_3^2)_\textrm{eff} = \ds\frac{ \lambda s}{\sqrt{2}} B_\textrm{eff} + \widehat{m}_3^2 \ee and
\be  \mu_\textrm{eff} = \mu + \lambda \frac{s}{\sqrt{2}} \;\;\;\; B_\textrm{eff}\equiv A_\lambda+\ds\frac{\kappa s}{\sqrt{2}} \;\;\;\; \widehat{m}_3^2 = m_3^2 + \lambda (\ds\frac{\mu^\prime s}{\sqrt{2}} + \xi_F) \ee



%% Eq.(\ref{eq:mind}, \ref{eq:minu}) can be rewritten as
%% \begin{eqnarray}
%% 	\mu_\textrm{eff}^2&=&\frac{\overline{m}_{H_1}^2-\overline{m}_{H_2}^2t^2}{t^2-1}-\frac{1}{2}\overline{M}_z^2,\label{nmssm_mu}\\
%% 	 (m_3^2)_\textrm{eff}&=&\frac{1}{2}\sin{2\beta}\left(\overline{m}_{H_2}^2+\overline{m}_{H_1}^2+ 2\mu_\textrm{eff}^2\left(1+\frac{\overline{M}_z^2}{\overline{g}^2s^2}\right)\right)\label{nmssm_bmu}
%% \end{eqnarray}
%% with  and we have also defined, 
%% \ba \overline{m}^2_{H_1} &=&  m^2_{H_1} - \frac{1}{v_1}\frac{\partial \Delta V}{\partial v_1}, \quad
%%  \overline{m}^2_{H_2} =  m^2_{H_2} - \frac{1}{v_2}\frac{\partial \Delta V}{\partial v_2}, \quad
%% \overline{M}_Z^2 = M_Z^2 + {\mathcal Re}\Pi_{ZZ}^T. \ea.
 

\subsection{Tree-level masses \label{sec:tree}}
The chargino and sfermion masses are given by the same expressions as in the MSSM with $\mu \rightarrow \mu_\textrm{eff}$. 

The Lagrangian contains the neutralino mass matrix as
$-\frac{1}{2}
{\tilde\psi^0}{}^T{\cal M}_{\tilde\psi^0}\tilde\psi^0$ + h.c., where
$\tilde\psi^0 =$ $(-i\tilde b,$ $-i\tilde w^3,$ $\tilde h_1,$ $\tilde
h_2, \tilde{s})^T$ and
%The Neutralinos mass matrix is, 
\begin{equation}
{\cal M}_{\tilde\psi^0} \ =\ \left(\begin{array}{ccccc} 
M_1 & 0 &-M_Zc_\beta s_W & M_Zs_\beta s_W & 0 \\
 0 & M_2 & M_Zc_\beta c_W & -M_Zs_\beta c_W & 0 \\ 
-M_Zc_\beta s_W & M_Zc_\beta c_W & 0 & -\mu & -\lambda v_2 \\
M_Zs_\beta s_W & -M_Zs_\beta c_W & -\mu & 0 & - \lambda v_1 \\
0 & 0 & 0 & 0 & 2 \kappa s + \mu^\prime
\end{array} \right). \label{mchi0}
\end{equation} 
We use $s$ and $c$ for sine and cosine, so that
$s_\beta\equiv\sin\beta,\ c_{\beta}\equiv\cos\beta$ and $s_W (c_W)$ is
the sine (cosine) of the weak mixing angle.  

The 5 by 5 neutralino mixing matrix is an orthogonal matrix $O$ with real
entries,  such that $O^T {\cal M}_{\tilde\psi^0} O$ is diagonal.
The neutralinos $\chi^0_i$ are defined such that their absolute masses
increase with increasing $i$. Some of their mass values can be negative. 

The CP-even gauge eigenstates $(H^0)^T = (H_1^0,\, H_2^0, \, S)$ are rotated into mass eigenstates by,
\be h^0 = R H^0, \ee with the mass matrix appearing in the Lagrangian as  $-(H^0)^T M_H^0 H^0$ and is given by,
\be
M_{H^0}^2=
\left(
\begin{array}{ccc}
\ds\frac{\partial^2 V}{\partial^2 v_1 } - \ds\frac{1}{v_1}\frac{\partial V}{\partial v_1}&
\ds\frac{\partial^2 V}{\partial v_1 \partial v_2}&
\ds\frac{\partial^2 V}{\partial v_1 \partial s}\\[0.3cm]
\ds\frac{\partial^2 V}{\partial v_2 \partial v_1}&
\ds\frac{\partial^2 V}{\partial^2 v_2} - \ds\frac{1}{v_2}\frac{\partial V}{\partial v_2}&
\ds\frac{\partial^2 V}{\partial v_2 \partial s}\\[0.3cm]
\ds\frac{\partial^2 V}{\partial s \partial v_1}&
\ds\frac{\partial^2 V}{\partial s \partial v_2}&
\ds\frac{\partial^2 V}{\partial^2 s} - \ds\frac{1}{s}\frac{\partial V}{\partial s},
\end{array} 
\right)
 \ee where we have rewritten the elements of $M_{H^0}^2$ by imposing tree level EWSB substitution on the the double derivatives of the effective potential, which is equivalent to defining,  \be(M_{H^0}^2)_{ij} \equiv  \ds\frac{\partial^2 V}{\partial v_i \partial v_j} - \ds\frac{\delta_{ij}}{v_i}\ds\frac{\partial V}{\partial v_i}, \ee with $v_3 \equiv s$.  The elements are then given as follows,   

\ba
 (M_{H^0}^2)_{11} & = & M_Z^2 c_\beta^2 + (\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2)\,\tan\beta,\\
 (M_{H^0}^2)_{12} & = & (4\lambda^2 - \overline{g}^2) \ds\frac{v_2 v_1 }{4}- 
\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} - \widehat{m}_3^2, \\ 
 (M_{H^0}^2)_{13} & = & \lambda (2 \mu_\textrm{eff}\,\ds\frac{ v_1}{\sqrt{2}} -
(B_\textrm{eff} + \kappa s + \mu')\ds\frac{ v_2}{\sqrt{2}}),\\
 (M_{H^0}^2)_{22} & = & M_Z^2 s_\beta^2 + (\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2)/\tan\beta\, \\
 (M_{H^0}^2)_{23} & = & \lambda (2 \mu_\textrm{eff}\, \ds\frac{ v_2}{\sqrt{2}} -
(B_\textrm{eff} + \frac{\kappa s}{\sqrt{2}} + \mu')\ds\frac{ v_1}{\sqrt{2}}), \\
 (M_{H^0}^2)_{33} & = & \ds\frac{1}{\sqrt{2}}\lambda (A_\lambda + \mu') \frac{v_2 v_1}{s}
+ \frac{\kappa s}{\sqrt{2}} (A_\kappa + 4\frac{\kappa s}{\sqrt{2}}+ 3 \mu') - \sqrt{2}(\xi_S + \xi_F \mu')/s.
\label{eq:MH0}
\ea

The three imaginary components of the neutral Higgs fields $(H^I)^T = (H^I_1, H_2^I, S^I)$ mix to give the two physical CP odd bosons and the Goldstone boson, $a^T = (G^0, A_1, A_2)$, with the two bases related by,
 \be a = P H^I \ee where $P$ matches the conventions of \cite{Degrassi:2009yq} and stripping the first row from $P$ leaves the 2 by 3 mixing matrix for the physical CP-odd Higgs bosons in SLHA2 conventions\cite{Allanach:2008qq}. Following the review of Ellwanger, Hugonie and Teixeira (EHT)\cite{Ellwanger:2009dp} we write the entries of the 3 by 3 mass matrix in the $H^I$ basis, $ M^{\prime \, 2}_{P}$, after imposing tree level EWSB as,
\ba
( M^{\prime \, 2}_{P})_{11} & = & (\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2)\,\tan\beta , \\
( M^{\prime \, 2}_{P})_{12} & = & \ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2, \\
( M^{\prime \, 2}_{P})_{13} & = & \lambda v_u (A_\lambda - 2\kappa s - \mu'), \\
( M^{\prime \, 2}_{P})_{22} & = & (\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2)/\tan\beta ,  \\
( M^{\prime \, 2}_{P})_{23} & = & \lambda v_d (A_\lambda - 2\kappa s - \mu')\\
( M^{\prime \, 2}_{P})_{33} & = & \lambda (B_\textrm{eff}+3\kappa s +\mu')\ds\frac{v_u
v_d}{s} -3\kappa A_\kappa s  -2 m_{S}'^2 -\kappa \mu' s 
-\xi_F\left(4\kappa + \frac{\mu'}{s}\right) -\ds\frac{\xi_S}{s}.
\label{eq:MA0}
\ea

Note that the mixing of the Goldstone boson, $G^0$ only depends on $\tan\beta$, as in the MSSM, as can be seen by first rotating by $\beta$, leaving a 2 by 2 block diagonal which may then be diagonalised as is shown in EHT\cite{Ellwanger:2009dp}.  Therefore the CP-odd mixing can be stored as a single mixing angle\footnote{SOFTSUSY does this internally storing $\theta_{A^0}$ in the sPhysical object (see Sec.\ref{}) but in the SLHA output gives the 3x2 mixing matrix, matching SLHA2 conventions.}.


The charged Higgs fields in mass basis give one massless charged Goldstone boson, $G^+$ and a charged Higgs, $H^\pm$, with mass,
\be m_{H^\pm}^2 = \left(\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2\right)(\tan \beta + \cot \beta) + M_W^2 - \ds\frac{\lambda^2 v^2}{2},\qquad. \ee
  
\section{Calculation Algorithm \label{sec:calculation}}
We now describe the algorithm used to perform the calculation.  The full iterative algorithm to determine the mass spectra is shown schematically in Fig.\ref{fig:algorithm}.  Here we will provide a detailed description of this procedure and specify all contributions taht are included in our calculations.  

As in the MSSM we match to Standard Model fermions and gauge boson masses, $\alpha(M_Z)$, $G_F^\mu$ and $\alpha_S(M_z)$.  The evolution below $M_Z$ proceeds as in the MSSM, as described in Section 3.1 of the MSSM SOFTSUSY manual\cite{Allanach:2001kg}.  The initial guess for the SUSY preserving $\overline{DR}$ parameters at $m_t$ also follows the procedure in \cite{Allanach:2001kg}, with new NMSSM parameters $\{\lambda, \kappa, s, \xi_F, \mu^\prime \}$ either initially set to their input values values or to zero in  the case of $\kappa$ and $s$ when they are to be output from the EWSB conditions.      

Following the initial guess the SUSY preserving parameters are evolved to a user specified $M_X$ scale with two loop RGEs. As in the MSSM version if gauge-unification has been specified as a boundary condition, $M_X$ is revised to leading log order to provide a more accurate value upon the next iteration:
\begin{equation}
M_X^{new} = M_X \exp \left({\frac{g_2(M_X) - g_1(M_X)}{g_1'(M_X) - g_2'(M_X)}}\right),
\label{mguteq}
\end{equation}
where primes denote derivatives calculated to 2-loop order.   

\begin{figure}
\begin{center}
\begin{picture}(323,245)
\put(10,0){\makebox(280,10)[c]{\fbox{7.\ Calculate Higgs and
      sparticle pole masses. Run to $M_Z$.}}}
\put(10,40){\makebox(280,10)[c]{\fbox{6.\ Run to $M_Z$.}}}
\put(150,76.5){\vector(0,-1){23}}
\put(10,80){\makebox(280,10)[c]{\fbox{5.\ Run to $M_X$. Apply soft breaking
and NMSSM SUSY boundary conditions.}}}
\put(150,116.5){\vector(0,-1){23}}
\put(10,120){\makebox(280,10)[c]{\fbox{4.\ EWSB with iterative solution for $\mu_\textrm{eff}$, outputs $\{s,\kappa,m_S\}$ in $Z_3$-NMSSM and $\{\mu, m_3^2, \xi_S \}$ in \Zv-NMSSM.}}}
\put(150,156){\vector(0,-1){23}}
\put(10,160){\makebox(280,10)[c]{\fbox{3.\ Run to $M_S$.}}}
\put(30,170){convergence}
\DashLine(115,165)(-70,165){5}
\DashLine(-70,165)(-70,5){5}
\DashLine(-70,5)(30,5){5}
\put(30,5){\vector(1,0){2}}
\put(150,197){\vector(0,-1){24}}
\put(150,239){\vector(0,-1){26}}
\put(60,245){\fbox{1.\ SUSY radiative corrections to
$g_i(M_Z)$}}
\put(10,200){\makebox(280,10)[c]{\fbox{2.\ $Y_E$, $Y_D$ include $v_k$
      contributions. Iterative solution of $Y_E$.}}} 
\put(182,45){\line(1,0){190}}
\put(371,45){\line(0,1){200}}
\put(371,245){\vector(-1,0){143}}
\end{picture}
\end{center}
\caption{Iterative algorithm used to calculate the NMSSM spectrum. 
The initial step is the
uppermost one. $M_S$ is the scale at which the EWSB
conditions 
are imposed, as discussed in the text. $M_X$ is the scale at which the high
energy SUSY breaking boundary conditions are imposed.
\label{fig:algorithm}}
\end{figure}


\subsection{Running of NMSSM couplings~\label{running}}
\red{--- LCT: Prologue not to be taken seriously (yet) ---}



\textcolor{red}{--- LCT: Up to here ---}

The program 
can be made to run faster by switching off the two-loop renormalisation of 
the scalar masses and tri-linear scalar couplings. All
$\beta$ functions are real and include inter-generational quark mixing
effects. 


The parameters are then evolved to the scale $M_{SUSY}= \equiv
\sqrt{m_{{\tilde t}_1}(M_{SUSY}) m_{{\tilde t}_2}(M_{SUSY})}$.  The
$\overline{DR}$ running masses for the mass eigenstates are calculated
using the expressions given in Section \ref{sec:tree}.
\subsection{Low energy boundary conditions and EWSB \label{ewsb}}
The low energy boundary conditions come from measured values of
Standard Model fermions and gauge boson masses, $\alpha(M_Z)$,
$G_F^\mu$ and $\alpha_S(M_z)$ and two input parameters, which then fix
the gauge and Yukawa couplings and the output parameters of
electroweak symmetry breaking.
 
   The three EWSB conditions allow the pole $Z$ mass, to be input with
   it's central value $M_Z$, while constraining three parameters.
   Equations \ref{eq:mind} and \ref{eq:minu} can be rewritten as in
   the MSSM.  Including tadpole corrections, $t_i$ and the transverse
   self energy of the $Z$ boson, $\Pi^T_{ZZ}$, these appear as, \ba
   \mu_\textrm{eff}^2(M_{SUSY}) &=&
   \frac{m_{\overline{H}_1}^2(M_{SUSY}) -
     m_{\overline{H}_2}^2(M_{SUSY}) \tan^2 \beta(M_{SUSY})}{\tan^2
     \beta(M_{SUSY}) - 1} - \frac{1}{2} M_{\overline Z}^2
   (M_{SUSY})\label{eq:mueffcond}\\ (m^2_3)_\textrm{eff}(M_{SUSY})&=&\frac{\sin{2\beta}(M_{SUSY})}{2}\left(\overline{m}_{H_u}^2(M_{SUSY})+\overline{m}_{H_d}^2(M_{SUSY})+
   2\mu_\textrm{eff}^2(M_{SUSY})\left(1+\frac{\overline{M}_z^2}{\overline{g}^2s^2}(M_{SUSY})\right)\right),\label{eq:bmucond}
   \ea where $m_{\overline{H}_i}^2 = m_{H_i}^2 - t_i/v_i$ and
   $M_{\overline Z}^2(M_{SUSY}) = M_Z^2 + \Re\Pi_{ZZ}^T(M_{SUSY})$ is
   the $\overline{DR}$ running (mass)$^2$ of the $Z$ boson and $\bar g
   = \sqrt{g_2^2+g^{\prime 2}}$ and $g_2$ and $g^{\prime}$ are the
   gauge couplings of $SU(2)_L$ and (unnormalised) $U(1)$ interactions
   respectively, with $g^\prime = \sqrt{3/5} \, g_1$.  In this way we
   can fix $\mu_{eff}$ and $(m^2_3)_\textrm{eff}$ in a similar manner
   as the MSSM.  However in this case these are effective parameters
   constructed from several model parameters, so we must select which
   ones are fixed.

In the $Z_3$-NMSSM we fix $s$ in Eq.~\ref{eq:mueffcond} and $\kappa$
in Eq.~\ref{eq:bmucond} and we use the third EWSB condition to fix
$m_S^2$.  In the \Zv-NMSSM we have more freedom and can choose to fix
$\mu$ and $m_3^2$ just as in the MSSM, and use the third EWSB
condition to fix $\xi_S$.

The full one loop tadpoles from \cite{Degrassi:2009yq} are used along
with NMSSM two loop $\oatas$ and $\oabas$ contributions to the
tadpoles are used from \cite{Degrassi:2009yq} (the FORTRAN files for
which were very helpfully supplied by Pietro Slavich) while two loop
corrections from the MSSM are used for $\oatq$, $\oabatau$, $\oabq$,
$\oatauq$ and $\oatab$, though it should be noted that these are not
complete in the NMSSM.
 
In both cases the tadpole corrections themselves depend on the output
from the EWSB conditions, therefore an iteration is employed to find a
self consistent solution.

After the EWSB iteration converges the parameters are run to $m_Z$.
Here the three gauge couplings $g_1$, $g_2$ and $g_3$, where $g_1$ is
the GUT normalised gauge coupling of $U(1)_Y$ and 3rd family
$\overline{DR}$ Yukawa couplings, $y_t$, $y_b$ and $y_\tau$ are fixed,
including the precision corrections at $M_Z$, in the same procedure as
described in Section 3.3 of \cite{Allanach:2001kg}.  However the one
loop self energies of the gauge bosons and fermions are modified to
match those given in \cite{Degrassi:2009yq} for the NMSSM.
\textcolor{red}{--- PA: Add comment on the delta rho corrections and
  the Higgs ---}

In the \Zv-NMSSM $\kappa$, $s$, $\xi_F$ and $\mu^\prime$ are also
reset to their input values at $M_Z$.  The parameters are then evolved
back to $M_{SUSY}$ where $M_Z^2$ and $\tan\beta$ are predicted as
part of a consistency check and if the user has specified that
$\lambda$ is to be input at the SUSY scale then $\lambda$ is set here.


The parameters are then evolved back up to $M_X$ and the procedure is repeated until convergence is achieved, as shown in Fig.~\ref{fig:algorithm}. 

\subsection{NMSSM spectrum \label{spec}}
After the iteration has converged we calculate the pole masses.  The
Higgs pole masses are calculated using one loop self energies from
\cite{Degrassi:2009yq} with additional contributions to the Higgs self
couplings from \Zv couplings added using Appendix A of
EHT\cite{Ellwanger:2009dp}.  Two loop corrections of order $\oatas$ and
$\oabas$ are adding from \cite{Degrassi:2009yq} using the FORTRAN
files provided by Pietro Slavich.  Contributions of order $\oatq$,
$\oabatau$, $\oabq$, $\oatauq$ and $\oatab$, are included from the
MSSM files (which were also supplied by Pietro Slavich) but these are
not complete in the NMSSM, so our calculation is not correct to this
order, but rather to $\oatas$ and $\oabas$, though the additional
pieces give a good approximation when not too far away from the MSSM
limit and allow an easier comparisons against MSSM results.

The sfermions, neutralinos and charginos also receive new NMSSM
corrections to their self energies. To the best of our knowledge these
only appear in literature in \cite{Staub:2010ty}.  However we found a
number of typos in the self energies, and from checking with the
authors we realised that these appeared during editing for length and
that the self energies generated by SARAH
\cite{Staub:2009bi,Staub:2010jh,Staub:2012pb,Staub:2013tta} did not
contain these problems.  Therefore we used a combination of that paper
and also auto-generated Latex output from SARAH showing these self
energies, as well as simple checks by deriving a few things ourselves.

Finally all one loop self energies, Tadpoles and two loop RGEs were unit tested against code pieces auto-generated from FLEXIBLE SUPERSYMMETRY \cite{flexi-susy}, an in development MATHEMATICA package for generating C++ code which makes use of the aforementioned SARAH package\cite{Staub:2009bi,Staub:2010jh,Staub:2012pb,Staub:2013tta}. 


\section*{Acknowledgments}
This work has been partially supported by STFC\@. We thank Pietro
Slavich for supplying us with the NMSSM FORTRAN files with two loop
$\oatas$ and $\oabas$ contributions to the Higgs masses and also a
FORTRAN file with one loop self energies which we used as a cross
check as well as his helpful explanations on how to use them. We would
also like to thank Florian Staub for responding quickly to our questions
regarding JHEP {\bf 1010}, 040 (2010) and on questions and bug reports
when comparing against SARAH and FLEXIBLE SUPERSYMMETRY. PA and AV
would also like to thank Dominik St\"ockinger for many helpful
comments and discussions regarding the precision corrections included
here and would also like to thank both him and Jae-hyeon Park for
listening to a number of discussions about this project in general and
offering helpful remarks.


\appendix

\section{Running \SOFTSUSY}
\label{sec:run}

\SOFTSUSY~produces an executable called \code{softpoint.x}. For the calculation
of the spectrum of single points in parameter space, we recommend the
SUSY Les Houches Accord 2 (SLHA2)~\cite{Allanach:2008qq}  input/output
option. The user must provide a file (\textit{e.g.} the example file included
in the \SOFTSUSY~distribution
\code{rpvHouchesInput}), that specifies the model dependent input
parameters. The program may then be run with
\small
\begin{verbatim}
 ./softpoint.x leshouches < nmssmHouchesInput
\end{verbatim}
\normalsize
For the SLHA2 input option, 
the output will also be given in 
SLHA2 format. Such output can be used for
input into other programs which subscribe to the accord, such as
\code{PYTHIA}~\cite{Sjostrand:2007gs} (for
simulating sparticle production and decays at colliders), for example. For
further details on the necessary format of 
the input file, see ref.~\cite{Allanach:2008qq}. It supports 
the setting of all other SLHA2 input blocks associated with non-complex
couplings. 

$M_{GUT}$ is used (defined to be the $\overline{DR}$ scale $Q$ at which $g_1(Q) =
g_2(Q)$). The default output is in SLHA2 format, the conventions of which are
explained in Ref.~\cite{Allanach:2008qq}. 


\section{Class Structure\label{sec:objects}}

We now go on to sketch the NMSSM class hierarchy.  Only methods and
data which are deemed of possible importance for prospective users are
mentioned here, but there are many others within the program itself.


\subsection{General structure}

\begin{figure}
  \begin{center}
    \begin{picture}(200,200)
      \GBox(200,200)(0,0){0.9}
      \ArrowLine(100,180)(100,150)
      \ArrowLine(100,150)(100,110)
      \ArrowLine(100,110)(100,60)
      \SetPFont{Teletype}{10}
      \put(0,0){\framebox(200,200){}}
      \BText(100,180){RGE}
      \BText(100,150){MssmSusy}
      \B2Text(100,110){SoftPars<MssmSusy>}{= SoftParsMssm}
      \B2Text(100,60){Softsusy<SoftParsMssm>}{= MssmSoftsusy}
    \end{picture}\hfill
    \begin{picture}(200,200)
      \GBox(200,200)(0,0){0.9}
      \ArrowLine(100,175)(100,150)
      \ArrowLine(100,150)(100,125)
      \ArrowLine(100,125)(100,100)
      \ArrowLine(100,100)(100,75)
      \ArrowLine(100,75)(100,50)
      \ArrowLine(100,50)(100,25)
      \SetPFont{Teletype}{10}
      \put(0,0){\framebox(200,200){}}
      \BText(100,175){RGE}
      \BText(100,150){MssmSusy}
      \BText(100,125){NmssmSusy}
      \BText(100,100){SoftPars<NmssmSusy>}
      \BText(100,75){SoftParsNmssm}
      \BText(100,50){Softsusy<SoftParsNmssm>}
      \BText(100,25){NmssmSoftsusy}
    \end{picture}
    \caption{\label{fig:objstruc} Heuristic high-level class
      structure of \SOFTSUSY\@. Inheritance is displayed by the
      arrows and typedefs are displayed by the equals signs.}
  \end{center}
\end{figure}

To implement the NMSSM (and other non-minimal supersymmetric models),
the \SOFTSUSY\ class hierarchy was generalized with the following
requirements in mind:
%
\begin{itemize}
\item The class of supersymmetric parameters (gauge couplings,
  superpotential parameters and VEVs), whose beta functions are
  independent of soft-breaking parameters, should be at the top of the
  class hierarchy.  This makes them usable independently of the
  soft-breaking parameters, for example during the initial guess.

\item One should be able to reuse as much MSSM code as possible, for
  example by inheriting from existing MSSM classes.
\end{itemize}

The above requirements were implemented by the following changes:
%
\begin{enumerate}
\item The class of the soft breaking MSSM parameters and their beta
  functions was converted into the class template \code{SoftPars<Susy>}.
  The template parameter represents the class of supersymmetric
  parameters, from which \code{SoftPars<Susy>} inherits.  The class
  which contains \emph{all} MSSM parameters and beta functions,
  \code{SoftParsMssm}, was made a typdef for
  \code{SoftPars<MssmSusy>}, where \code{MssmSusy} is the class that
  contains the supersymmetric MSSM parameters and beta functions.
\begin{verbatim}
template <class Susy>
class SoftPars : public Susy {
   // implementation of soft breaking MSSM parameters
   // and their beta functions
};

typedef SoftPars<MssmSusy> SoftParsMssm;
\end{verbatim}
  This approach makes it possible to have a class of soft breaking
  MSSM parameters but with a different set of supersymmetric
  parameters.  This mechanism is used in the NMSSM, see Section
  \ref{nmssmsoftpars}.

\item The class which organises the MSSM mass spectrum calculation was
  converted into the class template \code{Softsusy<SoftPars>}.  The
  template parameter represents the class of all model parameters and
  beta functions, from which \code{Softsusy<SoftPars>} inherits.
  \code{MssmSoftsusy} was made a typedef for
  \code{Softsusy<SoftParsMssm>}.
\begin{verbatim}
template <class SoftPars>
class Softsusy : public SoftPars {
   // organisation of MSSM mass spectrum calculation
   // using model parameters in SoftPars
};

typedef Softsusy<SoftParsMssm> MssmSoftsusy;
\end{verbatim}
  This approach makes it possible to have a MSSM spectrum calculation
  class but with an arbitrary set of model parameters.  This mechanism
  is used in the NMSSM, see Section \ref{nmssmsoftsusy}.
\end{enumerate}

\subsection{\code{NmssmSusy}~class}
\label{nmssmsusy}

The class of supersymmetric NMSSM parameters and beta functions,
\code{NmssmSusy}, inherits from \code{MssmSusy} to reuse the MSSM
ones, see \figurename~\ref{fig:objstruc}.

\subsection{\code{SoftParsNmssm}~class}
\label{nmssmsoftpars}

To implement the class of soft-breaking NMSSM parameters,
\code{SoftParsNmssm}, the \code{SoftPars<Susy>} template is
instantiated using \code{NmssmSusy} as template parameter.  Thereby
one obtains the class of MSSM soft-breaking beta functions, using
supersymmetric NMSSM parameters.  \code{SoftParsNmssm} then inherits
from \code{SoftPars<NmssmSusy>} to add extra NMSSM contributions to
the soft-breaking beta functions:
%
\begin{verbatim}
class NmssmSusy : public MssmSusy {
   // implement supersymmetric NMSSM parameter beta functions
   // by reusing MSSM ones
};

class SoftParsNmssm : public SoftPars<NmssmSusy> {
   // implement soft-breaking NMSSM parameter beta functions
   // by reusing MSSM ones
};
\end{verbatim}

\subsection{\code{NmssmSoftsusy}~class}
\label{nmssmsoftsusy}

To create the NMSSM spectrum calculation class, \code{NmssmSoftsusy},
the \code{Softsusy<SoftPars>} template class is instantiated using
\code{SoftParsNmssm} as template parameter.  Thereby one obtains a
MSSM spectrum calculator, which uses NMSSM parameters and beta
functions.  \code{NmssmSoftsusy} then inherits from
\code{Softsusy<SoftParsNmssm>} and overwrites MSSM functions to
account for the extra NMSSM particles:
%
\begin{verbatim}
class NmssmSoftsusy : public Softsusy<SoftParsNmssm> {
   // organise NMSSM spectrum calculation reusing MSSM functions
};
\end{verbatim}

\section{Renormalization Group Equations for the NMSSM}
For a general, ${\cal N}=1$ semi-simple SUSY gauge theory, the expressions \cite{MV94,Yam94} 
for the one- and two-loop renormalization group equations (RGEs) in the 
$\overline{\mbox{DR}}$ scheme are known.%
\footnote{Herein, the term `RGEs' refers to the one- and two-loop expressions --- higher order contributions are not considered.}
From these results, it is possible to derive the explicit form of the RGEs in a 
chosen model, e.g.\ the work of Martin and Vaughn \cite{MV94} provides a 
complete list of the RGEs for the MSSM.  

In the case of the $\Zv$ NMSSM considered in this work, it is a simple task to generalise the MSSM expressions \cite{MV94} to include contributions due to superpotential parameters such as $\lambda$ and their soft SUSY-breaking counterparts $a_\lambda$.  Naturally, the RGEs for such parameters must be derived separately.  

In the third generation approximation
%
\begin{equation}
Y_U \approx \left(\begin{array}{c c c} 
0 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & y_t 
\end{array}\right) \,, \qquad
%
Y_D \approx \left(\begin{array}{c c c} 
0 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & y_b 
\end{array}\right) \,, \qquad
%
Y_E \approx \left(\begin{array}{c c c} 
0 & 0 & 0 \\
0 & 0 & 0 \\
0 & 0 & y_e 
\end{array}\right)\,, 
\end{equation}
%
the RGEs for the $\Zv$ NMSSM can be found in the work of Ellwanger et al.\ \cite{Ellwanger:2009dp}.

The expressions for these additional contributions are listed below, where we have included effects due to inter-generation quark mixing.  In the interest of brevity we refer the reader to the MSSM results \cite{MV94} where necessary. 

\subsection{Yukawa Couplings}
For $t = \ln Q$, the trilinear superpotential parameter $Y^{ijk}$ evolves 
according to the general expression \cite{MV94}
%
\begin{equation}
\dt Y^{ijk} = Y^{ijp}\Gamma_p^k + Y^{kjp}\Gamma_p^i + Y^{ikp}\Gamma_p^j\,,
\label{eq:Yuk rges}
\end{equation}
%
where 
%
\begin{equation}
\Gamma_i^j = \frac{1}{16\pi^2}\gamma_i^{(1)j} 
+ \frac{1}{(16\pi^2)^2}\gamma_{i}^{(2)j}\,, 
\end{equation}
%
and $\gamma^{(1,2)j}_i$ are the one- and two-loop anomalous dimensions 
respectively.  Note that the $3\times 3$ Yukawa matrices $Y_{U,D,E}$ are 
obtained by identifying indices in (\ref{eq:Yuk rges}) with the relevant chiral superfields in the superpotential.%
\footnote{For example, for $k=H_2$ we have $Y^{ijH_2}\equiv (Y_U)^{ij}$.}  

At one-loop order, the only addition to the MSSM expressions 
\cite{MV94} for the $Y_{U,D,E}$ RGEs is the inclusion of $\lamsq$ terms 
which originate from the Higgs anomalous dimensions
%
\begin{align}
\left.\gamma^{(1) H_1}_{H_1}\right|_\lambda = \lamsq 
\quad \mbox{and} \quad \left.\gamma^{(1) H_2}_{H_2} \right|_\lambda = \lamsq\,.
\end{align}
%
At two-loop order, all the gauge-Yukawa contributions from $\lambda$ cancel for 
each $\gamma_i^{(2)j}$, so the additional contributions arising in the NMSSM are 
simply given by
%
\begin{align}
\left.\gamma_{L_i}^{(2)L_j}\right|_\lambda &= -\lamsq (Y_E Y_E^\dagger)_i^j\,, \\
%
\left.\gamma_{E_i}^{(2)E_j}\right|_\lambda &= -2\lamsq (Y_E^\dagger Y_E)_i^j\,, \\
%
\left.\gamma_{Q_i}^{(2)Q_j}\right|_\lambda &= -\lamsq (Y_U Y_U^\dagger)_i^j 
- \lamsq (Y_D Y_D^\dagger)_i^j\,, \\
%
\left.\gamma_{D_i}^{(2)D_j}\right|_\lambda &= -2\lamsq (Y_D^\dagger Y_D)_i^j\,, \\
%
\left.\gamma_{U_i}^{(2)U_j}\right|_\lambda &= -2\lamsq (Y_U^\dagger Y_U)_i^j \,, \\
%
\left.\gamma_{H_1}^{(2)H_1}\right|_\lambda &= -3\lambda^4 -2\lamsq\kapsq 
- 3\lamsq \tr(Y_U Y_U^\dagger)\,, \\
%
\left.\gamma_{H_2}^{(2)H_2}\right|_\lambda &= -3\lambda^4 -2\lamsq\kapsq 
- 3\lamsq \tr(Y_D Y_D^\dagger) - \lamsq \tr(Y_E Y_E^\dagger)\,.
\end{align}
%

In a similar manner, the RGEs for $\lambda$ and $\kappa$ are obtained from Eq.~(\ref{eq:Yuk rges}), with
\begin{align}
\dt\lambda &= \lambda (\Gamma^{H_1}_{H_1} + \Gamma^{H_2}_{H_2} + \Gamma^S_S)\,, \\
%
\dt\kappa &= 3\kappa \Gamma_S^S\,,
\end{align}
%
where the one- and two-loop expressions for the singlet anomalous dimension 
are given by
%
\begin{align}
\gamma_S^{(1)S} &= 2\lamsq + 2\kapsq\,,\\
%
\gamma_S^{(2)S} &= -4\lambda^4 - 8\kappa^4 - 8 \kapsq\lamsq 
- 6\lamsq \tr(Y_UY_U^\dagger) - 6\lamsq \tr(Y_UY_U^\dagger) 
- 2\lamsq \tr(Y_EY_E^\dagger) + \tfrac{6}{5}g_1^2\lamsq + 6g_2^2\lamsq\,.
\end{align} 



\subsection{Gauge Couplings}
In the NMSSM, the one-loop RGEs of the for the gauge couplings $g_a$ are 
identical to those for the MSSM.  At two-loop order however, the $\lambda$ 
coupling appears through the term
%
\begin{equation}
\dt g_a \ni - \frac{g_a^3}{(16\pi^2)^2} Y_{ijk}Y^{ijk} C_a(k)/d(G_a)\,,  
\label{eqn:dg}
\end{equation}
%
where $d(G_a)$ is the dimension of the adjoint representation of gauge group 
$G_a$.  The result is
%
\begin{equation}
\left. \dt g_a\right|_\lambda = -\frac{g_a^3}{(16\pi^2)^2}\lamsq \Lambda_a^{(2)}\,,
\qquad \Lambda_a^{(2)} = (\tfrac{6}{5},2,0)\,,
\label{eq:dg}
\end{equation}
%
where we have taken into account the additional factor of 2 which arises from 
tracing over $SU(2)$ group indices in Eq.~(\ref{eqn:dg}).

\subsection{Gaugino Mass Parameters}
As for the gauge couplings above, we only need to consider the addition of the 
$\lambda^2$ terms arising from
%
\begin{equation}
\dt M_a \ni \frac{2g_a^2}{(16\pi^2)^2} 
\frac{(T_A^{ijk} - M_a Y^{ijk}) Y_{ijk}C_a(k)}{d(G_a)}\,,
\label{eqn:dM}
\end{equation}
%
where $T_A^{ijk}$ is a trilinear soft SUSY-breaking parameter. By evaluating the summations in (\ref{eqn:dM}), we find
%
\begin{equation}
\left. \dt M_a\right|_{\lambda} = \frac{2g_a^2}{(16\pi^2)^2} (\lambda a_\lambda - \lambda^2 M_a)\Lambda^{(2)}_a\,,
\end{equation}
%
with $\Lambda_a^{(2)}$ as given in (\ref{eq:dg}).

\subsection{$\mu$ Parameters}
The general expression \cite{MV94,Yam94} for the SUSY-conserving bilinear terms is given by  
%
\begin{equation}
\dt \mu^{ij} = \mu^{ip}\Gamma_p^j + \mu^{jp}\Gamma_p^i\,,
\end{equation}
%
from which we obtain
%
\begin{align}
\dt\mu &= \mu (\Gamma_{H_1}^{H_1} + \Gamma_{H_2}^{H_2}), \notag \\
%
\dt\mu' &= 2\mu' \Gamma_S^S
\end{align}
%

\subsection{Trilinear Couplings}
If we denote $T_A^{ijk}$ as a soft SUSY-breaking trilinear, then the evolution at two-loop is given by 
%
\begin{equation}
\dt T_A^{ijk} = \frac{1}{16\pi^2} \left[\beta_{T_A}^{(1)}\right]^{ijk} 
+ \frac{1}{(16\pi^2)^2} \left[\beta_{T_A}^{(2)}\right]^{ijk}\,,
\end{equation}
%
where the explicit expressions for the $\beta$ functions can be found in \cite{MV94}.  
For $T = U,D,E$, the $\lambda$ contribution to the one-loop $\beta$ function 
arises from the following factor
%
\begin{equation}
\left[\beta_{T_A}^{(1)}\right]^{ij} \ni \tfrac{1}{2} (T_A)^{ij} 
Y_{H_\alpha mn}Y^{mnH_\alpha} + (Y_x)^{ij} Y_{H_\alpha mn}T_A^{mnH_\alpha}\,,
\end{equation}
%
where there is {\it no summation} over $\alpha = 1,2$, with the index 
determined by the choice of $T$ (e.g.\ if $T=U$ then $\alpha = 2$). Expanding 
the indices leads to
%
\begin{equation}
\left.\left[\beta_{T_A}^{(1)}\right]^{ij}\right|_\lambda = (T_A)^{ij}\lambda^2 
+ (Y_x)^{ij} 2\lambda a_\lambda\,. \label{eqn: beta hx}
\end{equation}
%

The two-loop expressions involve a large number of summations so to minimize the proliferation of generation indices we choose to express our results in terms of $3\times 3$ matrices:
%
\begin{align}
\left.\beta_{ U_A}^{(2)}\right|_\lambda =& -\lamsq U_A\big[ 3\lamsq + 2\kapsq 
+ 3\tr( Y_D Y_D^\dagger) + \tr( Y_E Y_E^\dagger) \big] 
-\lamsq\big[ 5 Y_U Y_U^\dagger U_A + 4 U_A Y_U^\dagger Y_U +  Y_D Y_D^\dagger U_A 
+ 2 D_A Y_D^\dagger Y_U \big] \notag \\
%
&-2\lambda  a_\lambda Y_U\big[ 3\lamsq + 2\kapsq + 3\tr( Y_D Y_D^\dagger) 
+ \tr( Y_E Y_E^\dagger) \big] -2\lamsq Y_U\big[ 3\lambda  a_\lambda 
+ 2\kappa a_\kappa + 3\tr( D_A Y_D^\dagger) + \tr( E_A Y_E^\dagger) \big] \notag \\
%
&-2\lambda  a_\lambda\big[ 3 Y_U Y_U^\dagger Y_U +  Y_D Y_D^\dagger Y_U \big]\,, \\
%
%
\left.\beta_{ D_A}^{(2)}\right|_\lambda =& -\lamsq D_A\big[ 3\lamsq + 2\kapsq 
+ 3\tr( Y_U Y_U^\dagger) \big] 
-\lamsq\big[ 5 Y_D Y_D^\dagger D_A + 4 D_A Y_D^\dagger Y_D + 2 U_A Y_U^\dagger Y_D 
+  Y_U Y_U^\dagger D_A \big] \notag \\
%
&-2\lambda  a_\lambda  Y_D\big[ 3\lamsq + 2\kapsq + 3\tr( Y_U Y_U^\dagger) \big]
-2\lamsq Y_D\big[ 3\lambda  a_\lambda + 2\kappa a_\kappa 
+ 3\tr( U_A Y_U^\dagger) \big] -2\lambda  a_\lambda\big[ 3 Y_D Y_D^\dagger Y_D 
+  Y_U Y_U^\dagger Y_D\big]\,,  \\
%
%
\left.\beta_{ E_A}^{(2)}\right|_\lambda =& -\lamsq  E_A\big[ 3\lamsq + 2\kapsq 
+ 3\tr( Y_U Y_U^\dagger) \big] 
-\lamsq\big[ 5 Y_E Y_E^\dagger E_A + 4 E_A Y_E^\dagger Y_E \big] 
-2\lambda  a_\lambda  Y_E\big[ 3\lamsq + 2\kapsq + 3\tr( Y_U Y_U^\dagger) \notag \\
%
&-2\lamsq Y_E\big[ 3\lambda a_\lambda + 2\kappa a_\kappa + 3\tr( U_A Y_U^\dagger) 
\big] -6\lambda a_\lambda  Y_E Y_E^\dagger Y_E\,.
\end{align}

For $a_\lambda$, the one-loop $\beta$ function reads in full
%
\begin{align}
\beta_{a_\lambda}^{(1)} =&\, \tfrac{1}{2}a_\lambda (Y_{H_1mn}Y^{mnH_1} + Y_{H_2mn}Y^{mnH_2}
 + Y_{Smn}Y^{mnS}) + \lambda (Y_{H_1mn}T_A^{mnH_1} + Y_{H_2mn}T_A^{mnH_2} 
+ Y_{Smn}T_A^{mnS}) \notag \\
%
&- 4\sum_{a=1,2,3} (a_\lambda - 2M_a\lambda)g_a^2C_a(H)\,,
\end{align}
%
from which the various sums immediately yield
%
\begin{align}
\beta_{a_\lambda}^{(1)} =&\, a_\lambda[3\tr( Y_U  Y_U^\dagger) + 3\tr( Y_D  Y_D^\dagger) 
+ \tr( Y_E  Y_E^\dagger) + 12\lamsq + 2\kapsq - \tfrac{3}{5}g_1^2 - 3g_2^2] 
\notag \\
%
&+ \lambda[6\tr( U_A  Y_U^\dagger) + 6\tr( D_A  Y_D^\dagger) + 2\tr( E_A  Y_E^\dagger)
+ 4a_\kappa\kappa + \tfrac{6}{5}g_1^2M_1 + 6g_2^2M_2]\,.
\end{align}
%
The two-loop expression is given by
\begin{align}
\beta_{a_\lambda}^{(2)} =&-50\lambda^4 a_\lambda 
- 36\lambda\tr(U_A Y_U^\dagger Y_U Y_U^\dagger) 
- 36\lambda\tr(D_A Y_D^\dagger Y_D Y_D^\dagger)
- 12\lambda\tr(E_A Y_E^\dagger Y_E Y_E^\dagger) 
- 9a_\lambda\tr( Y_U Y_U^\dagger Y_U Y_U^\dagger) \notag \\
%
&- 9a_\lambda\tr( Y_D Y_D^\dagger Y_D Y_D^\dagger) 
- 3a_\lambda\tr( Y_E Y_E^\dagger Y_E Y_E^\dagger) - 8\kappa^4 a_\lambda 
- 32\lambda\kappa^3 a_\kappa - 12\lamsq\kapsq a_\lambda \notag \\
%
&-18\lambda^3\big[ (\Alam)\tr( Y_U Y_U^\dagger) + \tr(U_A Y_U^\dagger)\big] 
- 18\lambda^3\big[(\Alam)\tr( Y_D Y_D^\dagger) + \tr(D_A Y_D^\dagger)\big] \notag \\
%
&-6\lambda^3\big[(\Alam)\tr( Y_E Y_E^\dagger) + \tr(E_A Y_E^\dagger)\big] 
-24\lambda^3\kapsq\big[ (\Alam) + (\Akap)\big]
-12\lambda\big[ \tr(U_A Y_U^\dagger Y_D Y_D^\dagger) 
+ \tr(D_A Y_D^\dagger Y_U Y_U^\dagger) \big] \notag \\
%
&-3\lamsq a_\lambda\big[ 3\tr( Y_U Y_U^\dagger) + 3\tr( Y_D Y_D^\dagger) 
+ \tr( Y_E Y_E^\dagger) \big] -6a_\lambda\tr( Y_U Y_U^\dagger Y_D Y_D^\dagger) 
+ \tfrac{12}{5}g_1^2\lamsq\big[ \tfrac{3}{2}a_\lambda - \lambda M_1\big] \notag \\
%
&+\tfrac{8}{5}g_1^2\lambda\big[ \tr(U_A Y_U^\dagger) - M_1\tr( Y_U Y_U^\dagger) \big]
-\tfrac{4}{5}g_1^2\lambda\big[ \tr(D_A Y_D^\dagger) - M_1\tr( Y_D Y_D^\dagger)\big] 
+\tfrac{12}{5}g_1^2\lambda\big[\tr(E_A Y_E^\dagger) - M_1\tr( Y_E Y_E^\dagger)\big] 
\notag \\
%
&+\tfrac{2}{5}g_1^2 a_\lambda\big[ 2\tr( Y_U Y_U^\dagger) - \tr( Y_D Y_D^\dagger) 
+ 3\tr( Y_E Y_e^\dagger) \big] + 12g_2^2\lamsq\big[ \tfrac{3}{2}a_\lambda 
- \lambda M_2\big] \notag \\
%
&+32g_3^2\lambda\big[ \tr(U_A Y_U^\dagger) - M_3\tr( Y_U Y_U^\dagger) \big]
+32g_3^2\lambda\big[\tr(D_A Y_D^\dagger) - M_3\tr( Y_D Y_D^\dagger) \big] 
+ 16g_3^2 a_\lambda\big[ \tr( Y_U Y_U^\dagger) + \tr( Y_D Y_D^\dagger) \big] \notag \\
%
&+ \tfrac{1}{50}g_1^4\lambda\big[ 207(\Alam) - 828M_1\big] 
+ \tfrac{1}{2}g_2^4\lambda\big[ 15(\Alam) - 60M_2\big]
+\tfrac{9}{5}g_1^2 g_2^2\lambda\big[ (\Alam) - 2(M_1 + M_2)\big] \,.
\end{align}

For $a_\kappa$, the one-loop calculation is similar to that of $a_\lambda$, with 
the result
%
\begin{equation}
\beta_{a_\kappa}^{(1)} = 18a_\kappa\kappa^2 + 12a_\lambda\kappa\lambda 
+ 6a_\kappa\lamsq\,.
\end{equation}
%
At two-loop we have
%
\begin{align}
\beta_{a_\kappa}^{2)} =& -120\kappa^4 a_\kappa - 12\lambda^4 a_\kappa 
- 48\lambda^3\kappa a_\lambda - 48\lamsq\kappa^3\big[ (\Alam) + (\Akap)\big]
-24\lamsq\kapsq a_\kappa \notag \\
%
&-36\lamsq\kappa\big[ \tr( U_A Y_u^\dagger) + (\Alam)\tr( Y_u Y_u^\dagger)\big]
-36\lamsq\kappa\big[ \tr( D_A Y_d^\dagger) + (\Alam)\tr( Y_d Y_d^\dagger)\big] 
\notag \\
%
&-12\lamsq\kappa\big[ \tr( E_A Y_e^\dagger) + (\Alam)\tr( Y_e Y_e^\dagger)\big]
-6\lamsq a_\kappa\big[ 3\tr( Y_u Y_u^\dagger) + 3\tr( Y_d Y_d^\dagger) 
+ \tr( Y_e Y_e^\dagger) \big] \notag \\
%
&+ \tfrac{36}{5}g_1^2\lamsq\kappa\big[ (\Alam) + \tfrac{1}{2}(\Akap) - M_1\big] 
+ 36g_2^2\lamsq \kappa\big[ (\Alam) + \tfrac{1}{2}(\Akap) - M_2 \big]\,.
\end{align}

\subsection{Higgs Masses}
To determine the $\lambda$ and $\kappa$ contributions to the Higgs masses, it is useful to define \cite{Ellwanger:2009dp} the following quantities 
%
\begin{align}
\mlamsq =& \mhdsq + \mhusq + \mssq + a_\lambda^2/\lamsq\,, \notag \\
%
\mkapsq =& 3\mssq + a_\kappa^2/\kapsq\,, \notag \\
%
\Musq =& \tr(\mqsq Y_u Y_u^\dagger) + \tr( Y_u\musq Y_u^\dagger)
+ \mhusq\tr( Y_u Y_u^\dagger) + \tr( U_A U_A^\dagger)\,, \notag \\
%
\Mdsq =& \tr(\mqsq Y_d Y_d^\dagger) + \tr( Y_d\mdsq Y_d^\dagger) 
+ \mhdsq\tr( Y_d Y_d^\dagger) + \tr( D_A D_A^\dagger)\,, \notag \\
%
\Mesq =& \tr(\mlsq Y_e Y_e^\dagger) + \tr( Y_e\mesq Y_e^\dagger) 
+ \mhdsq\tr( Y_e Y_e^\dagger) + \tr( E_A E_A^\dagger)\,. \notag \\
\end{align}
%
Both the up- and down-type Higgs masses $m_{H_2}$ and $m_{H_1}$ receive the same 
$\lambda$ contribution at one-loop order, 
%
\begin{equation}
\left.\beta_{m_{H_\alpha}^2}^{(1)}\right|_\lambda = 2\lamsq \mlamsq\,, \qquad \alpha = 1,2\,.
\end{equation}
%

The two-loop expressions for $m_{H_2}^2$ are 
%
\begin{align}
\left.\beta_{m_{H_2}^2}^{(2)}\right|_\lambda =& -12\lambda^4\big\{ M_\lambda^2 + (\Alam)^2\big\} 
- 6\lamsq\big\{ \Mdsq + M_\lambda^2\tr( Y_d Y_d^\dagger) + 2(a_\lambda/\lambda)\tr( D_A Y_d^\dagger) \big\} \notag \\
%
&-2\lamsq\big\{ \Mesq + M_\lambda^2\tr( Y_e Y_e^\dagger) + 2(a_\lambda/\lambda)\tr( E_A Y_e^\dagger)\big\}
%
-4\lamsq\kapsq\big\{ M_\lambda^2 + M_\kappa^2 + 2(a_\lambda/\lambda)(a_\kappa/\kappa) \big\}  \notag \\
%
&+ \tfrac{6}{5}g_1^2\lamsq(\mhdsq-\mhusq) \,,
\end{align}
%
with a similar result for $m_{H_1}^2$,
%
\begin{align}
\left.\beta_{m_{H_1}^2}^{(2)}\right|_\lambda =& -12\lambda^4\big\{M_\lambda^2 + (\Alam)^2\big\} 
- 6\lamsq\big\{ \Musq + M_\lambda^2\tr( Y_u Y_u^\dagger) + 2(a_\lambda/\lambda)\tr( U_A Y_u^\dagger) \big\} \notag \\
%
&-4\lamsq\kapsq\big\{ M_\lambda^2 + M_\kappa^2 + 2(a_\lambda/\lambda)(a_\kappa/\kappa) \big\} 
- \tfrac{6}{5}g_1^2\lamsq(\mhdsq-\mhusq)\,.
\end{align}

For the singlet mass $m_S$, the one-loop result is
%
\begin{equation}
\beta_{m_S^2}^{(1)} = Y_{Spq}Y^{pqS}m_S^2 + 2Y_{Spq}Y^{Spr}(m^2)^q_r + h_{Spq}h^{Spq}\,, \label{eqn:beta mSsq}
\end{equation}
%
where 
%
\begin{align}
Y_{Spq}Y^{Spr}(m^2)^q_r &= 2\lamsq(\mhdsq + \mhusq) + 4\kapsq m_S^2\,, \notag \\
%
h_{Spq}h^{Spq} &= 4a_\lambda^2 + 4a_\kappa^2\,,
\end{align}
%
and thus (\ref{eqn:beta mSsq}) becomes
%
\begin{equation}
\beta_{m_S^2}^{(1)} = 4\lamsq \mlamsq + 4\kapsq \mkapsq\,.
\end{equation}
%
At two-loop we get
\begin{align}
\beta_{m_S^2}^{(2)} =& -16\lambda^4\big\{ \mlamsq + (\Alam)^2\big\} - 32\kappa^4\big\{ \mkapsq + (\Akap)^2\big\}
-12\lamsq\big\{ \mlamsq\tr( Y_u Y_u^\dagger) + \Musq + 2(\Alam)\tr( U_A Y_u^\dagger)\big\} \notag \\
%
&- 12\lamsq\big\{ \mlamsq\tr( Y_d Y_d^\dagger) + \Mdsq + 2(\Alam)\tr( D_A Y_d^\dagger) \big\} 
- 4\lamsq\big\{ \mlamsq\tr( Y_e Y_e^\dagger) + \Mesq + 2(\Alam)\tr( E_A Y_e^\dagger) \big\} \notag \\
%
&- 16\lamsq\kapsq\big\{ \mlamsq + \mkapsq + 2(\Alam)(\Akap) \big\}
+ \tfrac{12}{5}g_1^2\lamsq \big\{ \mlamsq - 2M_1[(\Alam) - M_1] \big\} \notag \\
%
&+ 12g_2^2\lamsq\big\{ \mlamsq -2M_2[(\Alam) - M_2]\big\}
\end{align}

\subsection{Squark and Slepton Masses}
The squark and slepton masses only receive contributions from $\lambda,\kappa$ at two-loop order.  The results are listed below, where $\mathbf{1}$ is a $3\times 3$ unit matrix.
%
\begin{align}
\left.\beta_{\mqsq}^{(2)}\right|_\lambda =& -\lamsq \big\{ 2 Y_u^\dagger\musq Y_u + \mqsq Y_u Y_u^\dagger +  Y_u Y_u^\dagger\mqsq \notag 
+ 2\mhusq Y_u Y_u^\dagger + 2 U_A U_A^\dagger + 2\mlamsq Y_u Y_u^\dagger 
+ 2a_\lambda/\lambda(  Y_u U_A^\dagger +  U_A Y_u^\dagger) \big\} \notag \\
%
&-\lamsq\big\{ 2 Y_d^\dagger\mdsq Y_d + \mqsq Y_d Y_d^\dagger +  Y_d Y_d^\dagger\mqsq 
+ 2\mhdsq Y_d Y_d^\dagger + 2 D_A D_A^\dagger + 2\mlamsq Y_d Y_d^\dagger 
+ 2a_\lambda/\lambda(  Y_d D_A^\dagger +  D_A Y_d^\dagger) \big\} \notag \\
%
&+ \tfrac{2}{5}g_1^2\lamsq(\mhdsq - \mhusq)\mathbf{1}\,,
\end{align}
%
%
\begin{align}
\left.\beta_{\musq}^{(2)}\right|_\lambda =& -2\lamsq \big\{ 2 Y_u^\dagger\mqsq Y_u + \musq Y_u^\dagger Y_u +  Y_u^\dagger Y_u\musq 
+ 2\mhusq Y_u^\dagger Y_u + 2 U_A^\dagger U_A + 2\mlamsq Y_u^\dagger Y_u 
+ 2a_\lambda/\lambda(  Y_u^\dagger U_A +  U_A^\dagger Y_u) \big\}  \notag \\
%
&- \tfrac{8}{5}g_1^2\lamsq(\mhdsq - \mhusq)\mathbf{1}\,,
\end{align}
%
%
\begin{align}
\left.\beta_{\mdsq}^{(2)}\right|_\lambda =& -2\lamsq \big\{ 2 Y_d^\dagger\mqsq Y_d + \mdsq Y_d^\dagger Y_d +  Y_d^\dagger Y_d\mdsq 
+ 2\mhdsq Y_d^\dagger Y_d + 2 D_A^\dagger D_A + 2\mlamsq Y_d^\dagger Y_d 
+ 2a_\lambda/\lambda(  Y_d^\dagger D_A +  D_A^\dagger Y_d) \big\} \notag \\
%
&+ \tfrac{4}{5}g_1^2\lamsq(\mhdsq - \mhusq)\mathbf{1}\,,
\end{align}
%
%
\begin{align}
\left.\beta_{\mlsq}^{(2)}\right|_\lambda =& -\lamsq \big\{ 2 Y_e^\dagger\mesq Y_e + \mlsq Y_e Y_e^\dagger +  Y_e Y_e^\dagger\mlsq 
+ 2\mhdsq Y_e Y_e^\dagger + 2 E_A E_A^\dagger + 2\mlamsq Y_e Y_e^\dagger 
+ 2a_\lambda/\lambda(  Y_e E_A^\dagger +  E_A Y_e^\dagger) \big\} \notag \\
%
&- \tfrac{6}{5}g_1^2\lamsq(\mhdsq - \mhusq)\mathbf{1}\,,
\end{align}
%
%
\begin{align}
\left.\beta_{\mesq}^{(2)}\right|_\lambda =& -2\lamsq \big\{ 2 Y_e^\dagger\mlsq Y_e + \mesq Y_e^\dagger Y_e +  Y_e^\dagger Y_e\mesq 
+ 2\mhdsq Y_e^\dagger Y_e + 2 E_A^\dagger E_A + 2\mlamsq Y_e^\dagger Y_e
+ 2a_\lambda/\lambda(  Y_e^\dagger E_A +  E_A^\dagger Y_e) \big\} \notag \\
%
&+ \tfrac{12}{5}g_1^2\lamsq(\mhdsq - \mhusq)\mathbf{1}\,.
\end{align}

\subsection{Tadpole Terms}
The general RGE for a SUSY-conserving tadpole term reads
%
\begin{equation}
\dt L^i = L^p\Gamma_p^i\,,
\end{equation}
%
and thus for $i=S$ one has
%
\begin{equation}
\dt \xi_F = \xi_F \Gamma_S^S\,.
\end{equation}
%
For the soft SUSY-breaking term $\xi_S$, we use the general RGE from \cite{Yam94} because Martin and Vaughn \cite{MV94} do not include the tadpole as part of $\mathcal{L}_{\mathrm{soft}}$.  The relevant RGE reads
%
\begin{equation}
\dt \xi_S = \frac{1}{16\pi^2} \beta_{\xi_S}^{(1)} + \frac{1}{(16\pi^2)^2} \beta_{\xi_S}^{(2)}\,,
\end{equation}
%
where the one-loop $\beta$ function is given by
%
\begin{align}
\beta_{\xi^{}_S}^{(1)} &= 2(\lamsq + \kapsq)\xi^{}_S + 4(\lambda a_\lambda + \kappa a_\kappa)\xi^{}_F + 2\mu'(2\lambda m_3^2 + \kappa m_S'^2) \notag \\
%
&+ 4[\lambda\mu (\mhusq + \mhdsq) + \kappa\mu' \mssq]\mu_{jl} + 4a_\lambda m_3^2 + 2a_\kappa m_S'^2\,.
\end{align}
%
At two-loop we obtain
%
\begin{align}
\beta_{\xi^{}_S}^{(2)} =& -4\lambda^4\big\{ \xi_S + 4(\Alam)\xi_F\big\} 
- 8\kappa^4\big\{ \xi_S + 4(\Akap)\xi_F\big\} 
-6\lamsq\big\{ \xi_S\tr( Y_u Y_u^\dagger)+ 2[(\Alam)\tr( Y_u Y_u^\dagger) + \tr( U_A Y_u^\dagger)]\big\}\xi_F \notag \\
%
&-6\lamsq\big\{\xi_S\tr( Y_d Y_d^\dagger) + 2[(\Alam)\tr( Y_d Y_d^\dagger) + \tr( D_A Y_d^\dagger)]\big\}\xi_F  \notag \\
%
&-2\lamsq\big\{\xi_S\tr( Y_e Y_e^\dagger) + 2[(\Alam)\tr( Y_e Y_e^\dagger) + \tr( E_A Y_e^\dagger)]\big\}\xi_F \notag \\
%
&-8\lamsq\kapsq\big\{ \xi_S + 2[(\Alam) + (\Akap)]\xi_F\big\} \notag \\
%
&-12\lambda\big\{ \mtrisq[(\Alam) + \mu']\tr( Y_u Y_u^\dagger) + \mtrisq\tr( U_A Y_u^\dagger)
+ \mu\{\Musq + [(\Alam) + \mu']\tr( U_A Y_u^\dagger) + [\mhdsq + \mhusq]\tr( Y_u Y_u^\dagger)\} \big\} \notag \\
%
&-12\lambda\big\{ \mtrisq[(\Alam) + \mu']\tr( Y_d Y_d^\dagger) + \mtrisq\tr( D_A Y_d^\dagger)
+ \mu\{\Mdsq + [(\Alam) +\mu']\tr( D_A Y_d^\dagger) + [\mhdsq + \mhusq]\tr( Y_d Y_d^\dagger)\} \big\}  \notag \\
%
&-4\lambda\big\{ \mtrisq[(\Alam)+ \mu']\tr( Y_e Y_e^\dagger) + \mtrisq\tr( E_A Y_e^\dagger)
+ \mu\{\Mesq + [(\Alam) +\mu']\tr( E_A Y_e^\dagger) + [\mhdsq + \mhusq]\tr( Y_e Y_e^\dagger)\} \big\} \notag \\
%
&-8\lambda^3\big\{ \mtrisq[2(\Alam) + \mu'] + \mu[\mlamsq + (\Alam)[(\Alam) + \mu'] + \mhdsq + \mhusq]\big\} \notag \\
%
&-8\lamsq\kappa\big\{ \msprsq[(\Alam) + (\Akap) + \mu']
+ \mu'[\mlamsq + (\Alam)[(\Akap) + \mu'] + 2\mssq] \big\} \notag \\
%
&-8\kappa^3\big\{ \msprsq[2(\Akap) + \mu'] 
+ \mu'[\mkapsq + (\Akap)[(\Akap) + \mu'] + 2\mssq] \big\} \notag \\
%
&+ \tfrac{6}{5}\lambda g_1^2\big\{ 3\mtrisq[(\Alam) + \mu' - M_1]
+ 2\mu[\mhdsq + \mhusq -(\Alam)M_1 - \mu' M_1 + 2M_1^2] 
+ \lambda[2\xi_F[(\Alam) - M_1]  + \xi_S] \big\} \notag \\
%
&+ 3\lambda g_2^2\big\{ 3\mtrisq[(\Alam) + \mu' - M_2]
+ 2\mu[\mhdsq + \mhusq - (\Alam)M_2 - \mu' M_2 + 2M_2^2] 
+ \lambda[2\xi_F[(\Alam) - M_2] + \xi_S] \big\}\,.
\end{align}

\subsection{Additional Parameters}
Here we list the $\lambda$ and $\kappa$ contributions to the RGEs for the scalar masses $\mtrisq \equiv B\mu$ and $\msprsq \equiv B'\mu'$, and the evolution of the Higgs vevs $v_{1,2,s}$.  For the former, we get at one-loop
%
\begin{equation}
\left.\beta_{\mtrisq}^{(1)}\right|_\lambda = 2\lambda(3\lambda\mtrisq + 2\mu a_\lambda) + 2\lambda\kappa\msprsq\,.
\end{equation}
%
At two-loop we have
%
\begin{align}
\left.\beta_{\mtrisq}^{(2)}\right|_\lambda &= -2\lambda^4(7\mtrisq + 16\mu a_\lambda/\lambda) -3\lamsq\big\{ 5\mtrisq\tr( Y_u Y_u^\dagger) 
+ 2\mu[3\tr( U_A Y_u^\dagger) + (a_\lambda/\lambda)\tr( Y_u Y_u^\dagger)] \big\} \notag \\
%
&-3\lamsq\big\{ 5\mtrisq\tr( Y_d Y_d^\dagger) + 2\mu[3\tr( D_A Y_d^\dagger) 
+ (a_\lambda/\lambda)\tr( Y_d Y_d^\dagger) \big\} \notag \\
%
&-\lamsq\big\{5\mtrisq\tr( Y_e Y_e^\dagger) 
+ 2\mu[3\tr( E_A Y_e^\dagger) + (a_\lambda/\lambda)\tr( Y_e Y_e^\dagger)] \big\} \notag \\
%
&-4\lamsq\kapsq\big\{ \mtrisq + 2\mu[(a_\lambda/\lambda) + (a_\kappa/\kappa)] \big\} 
-8\lambda^3\kappa\big\{ m_S'^2 + \mu'(a_\lambda/\lambda)\big\} - 8\lambda\kappa^3\big\{m_S'^2 + \mu'(a_\kappa/\kappa)\big\} \notag \\
%
&+\tfrac{12}{5}g_1^2\lamsq(\mtrisq - \mu M_1) + 12g_2^2\lamsq(\mtrisq -\mu M_2) \,.
\end{align}

For $\msprsq$, the one-loop $\beta$ function reads
%
\begin{equation}
\beta_{\msprsq}^{(1)} = 4\lambda(\lambda\msprsq + 2\mu' a_\lambda) + 8\kappa(\kappa\msprsq + \mu' a_\kappa) + 8\lambda\kappa\mtrisq \,.
\end{equation}
%
%
At two-loop we have
\begin{align}
\beta_{\msprsq}^{(2)} =& -8\lambda^4\big\{\msprsq + 4\mu'(a_\lambda/\lambda)\big\} - 16\kappa^4\big\{ 2\msprsq + 5\mu'(a_\kappa/\kappa) \big\} 
- 16\lamsq\kapsq\big\{ 2\msprsq + \mu'[3(a_\lambda/\lambda) + 2(a_\kappa/\kappa)] \big\} \notag \\
%
&-12\lamsq\big\{ \msprsq\tr( Y_u Y_u^\dagger) + 2\mu'[(\Alam)\tr( Y_u Y_u^\dagger) + \tr( U_A Y_u^\dagger)] \big\} \notag \\
%
&-12\lamsq\big\{\msprsq\tr( Y_d Y_d^\dagger) + 2\mu'[(\Alam)\tr( Y_d Y_d^\dagger) + \tr( D_A Y_d^\dagger)] \big\} \notag \\
%
&-4\lamsq\big\{\msprsq\tr( Y_e Y_e^\dagger) + 2\mu'[(\Alam)\tr( Y_e Y_e^\dagger) + \tr( E_A Y_e^\dagger)] \big\} 
-16\lambda^3\kappa\big\{ \mtrisq + \mu(\Alam)\big \} \notag \\
%
&-24\lambda\kappa\big\{ \mtrisq\tr( Y_u Y_u^\dagger) + \mu\tr( U_A Y_u^\dagger)\big\} 
-24\lambda\kappa\big\{ \mtrisq\tr( Y_d Y_d^\dagger) + \mu\tr( D_A Y_d^\dagger)\big\} \notag \\
%
&-8\lambda\kappa\big\{ \mtrisq\tr( Y_e Y_e^\dagger) + \mu\tr( E_A Y_e^\dagger)\big\} 
+\tfrac{24}{5}\lambda\kappa g_1^2\big\{\mtrisq - \mu M_1\big\} + 24\lambda\kappa g_2^2\big\{\mtrisq - \mu M_2 \big\} \notag \\
%
&+\tfrac{12}{5}\lamsq g_1^2\big\{\msprsq + 2\mu'[(\Alam) - M_1]\big\} 
+12\lamsq g_2^2 \big\{\msprsq + 2\mu'[(\Alam) - M_2] \big\}\,.
\end{align}

At one-loop, the up- and down-type Higgs vevs $v_{u,d}$ receive additional contributions solely from $\lambda$ \cite{Sper13},
%
\be
\left.\beta^{(1)}_{v_\alpha}\right|_\lambda = -v_\alpha\lamsq\,, \qquad \alpha=1,2\,,
\ee
%
while the $\beta$ function for the singlet vev $s$ is given by
%
\be 
\beta^{(1)}_s = -2s(\lamsq + \kapsq)\,.
\ee
%
At two-loop, the $\beta$ functions are given by \cite{Sper13}
%
\begin{align}
\beta^{(2)}_{v_1} &= v_1\Bigg\{\gamma^{(2)H_1}_{H_1} - \Big(\tfrac{3}{10}g_1^2 + \tfrac{3}{2}g_2^2\Big)\Big[3\tr(Y_DY_D^\dagger) + \tr(Y_EY_E^\dagger) + \lamsq\Big] + R\Bigg\}\,, \\
%
\beta^{(2)}_{v_2} &= v_2\Bigg\{\gamma^{(2)H_2}_{H_2} - 
\Big(\tfrac{3}{10}g_1^2 + \tfrac{3}{2}g_2^2\Big)
\Big[3\tr(Y_UY_U^\dagger) + \lamsq\Big] + R\Bigg\}\,, \\
%
\beta^{(2)}_s &= s\gamma^{(2)S}_S\,,
\end{align}
%
where $R$ is an $O(g^4)$ polynomial whose expression is given in \red{[REF]}.

The one-loop $\beta$ function for $\tan\beta$ is the same in the NMSSM as the MSSM.  At two-loop, one has
%
\be
\beta^{(2)}_{t_\beta} = \tan\beta\Bigg\{\gamma^{(2)H_2}_{H_2} - 
\gamma^{(2)H_1}_{H_1} + \Big(\tfrac{3}{10}g_1^2 + \tfrac{3}{2}g_2^2\Big)
\frac{\beta^{(1)}_{t_\beta}}{\tan\beta}\Bigg\}
\ee


\begin{thebibliography}{10}
%\cite{Allanach:2001kg}
\bibitem{Allanach:2001kg} 
  B.~C.~Allanach,
  %``SOFTSUSY: a program for calculating supersymmetric spectra,''
  Comput.\ Phys.\ Commun.\  {\bf 143}, 305 (2002)
  [hep-ph/0104145].
  %%CITATION = HEP-PH/0104145;%%
  %716 citations counted in INSPIRE as of 20 Sep 2013

%\cite{Degrassi:2009yq}
\bibitem{Degrassi:2009yq} 
  G.~Degrassi and P.~Slavich,
  %``On the radiative corrections to the neutral Higgs boson masses in the NMSSM,''
  Nucl.\ Phys.\ B {\bf 825}, 119 (2010)
  [arXiv:0907.4682 [hep-ph]].
  %%CITATION = ARXIV:0907.4682;%%
  %35 citations counted in INSPIRE as of 21 Sep 2013
%\cite{Allanach:2008qq}
\bibitem{Allanach:2008qq} 
  B.~C.~Allanach, C.~Balazs, G.~Belanger, M.~Bernhardt, F.~Boudjema, D.~Choudhury, K.~Desch and U.~Ellwanger {\it et al.},
  %``SUSY Les Houches Accord 2,''
  Comput.\ Phys.\ Commun.\  {\bf 180}, 8 (2009)
  [arXiv:0801.0045 [hep-ph]].
  %%CITATION = ARXIV:0801.0045;%%
  %177 citations counted in INSPIRE as of 21 Sep 2013

%\cite{Ellwanger:2009dp}
\bibitem{Ellwanger:2009dp} 
  U.~Ellwanger, C.~Hugonie and A.~M.~Teixeira,
  %``The Next-to-Minimal Supersymmetric Standard Model,''
  Phys.\ Rept.\  {\bf 496}, 1 (2010)
  [arXiv:0910.1785 [hep-ph]].
  %%CITATION = ARXIV:0910.1785;%%
  %327 citations counted in INSPIRE as of 21 Sep 2013

%\cite{MV94}
\bibitem{MV94} 
  S.~P.~Martin and M.~T.~Vaughn,
  %``Two loop renormalization group equations for soft supersymmetry breaking couplings,''
  Phys.\ Rev.\ D {\bf 50}, 2282 (1994)
  [Erratum-ibid.\ D {\bf 78}, 039903 (2008)]
  [hep-ph/9311340].
  %%CITATION = HEP-PH/9311340;%%
  %568 citations counted in INSPIRE as of 24 Sep 2013

%\cite{Yam94}
\bibitem{Yam94} 
  Y.~Yamada,
  %``Two loop renormalization group equations for soft SUSY breaking scalar interactions: Supergraph method,''
  Phys.\ Rev.\ D {\bf 50}, 3537 (1994)
  [hep-ph/9401241].
  %%CITATION = HEP-PH/9401241;%%
  %225 citations counted in INSPIRE as of 24 Sep 2013

%\cite{Ell08}
\bibitem{Ell08} 
  U.~Ellwanger, C.~-C.~Jean-Louis and A.~M.~Teixeira,
  %``Phenomenology of the General NMSSM with Gauge Mediated Supersymmetry Breaking,''
  JHEP {\bf 0805}, 044 (2008)
  [arXiv:0803.2962 [hep-ph]].
  %%CITATION = ARXIV:0803.2962;%%
  %28 citations counted in INSPIRE as of 24 Sep 2013

  %\cite{Staub:2010ty}
\bibitem{Staub:2010ty} 
  F.~Staub, W.~Porod and B.~Herrmann,
  %``The Electroweak sector of the NMSSM at the one-loop level,''
  JHEP {\bf 1010}, 040 (2010)
  [arXiv:1007.4049 [hep-ph]].
  %%CITATION = ARXIV:1007.4049;%%
  %28 citations counted in INSPIRE as of 12 Oct 2013

%\cite{Staub:2009bi}
\bibitem{Staub:2009bi} 
  F.~Staub,
  %``From Superpotential to Model Files for FeynArts and CalcHep/CompHep,''
  Comput.\ Phys.\ Commun.\  {\bf 181}, 1077 (2010)
  [arXiv:0909.2863 [hep-ph]].
  %%CITATION = ARXIV:0909.2863;%%
  %64 citations counted in INSPIRE as of 12 Oct 2013

%\cite{Staub:2010jh}
\bibitem{Staub:2010jh} 
  F.~Staub,
  %``Automatic Calculation of supersymmetric Renormalization Group Equations and Self Energies,''
  Comput.\ Phys.\ Commun.\  {\bf 182}, 808 (2011)
  [arXiv:1002.0840 [hep-ph]].
  %%CITATION = ARXIV:1002.0840;%%
  %60 citations counted in INSPIRE as of 12 Oct 2013

%\cite{Staub:2012pb}
\bibitem{Staub:2012pb} 
  F.~Staub,
  %``SARAH 3.2: Dirac Gauginos, UFO output, and more,''
  Computer Physics Communications {\bf 184}, pp. 1792 (2013)
  [Comput.\ Phys.\ Commun.\  {\bf 184}, 1792 (2013)]
  [arXiv:1207.0906 [hep-ph]].
  %%CITATION = ARXIV:1207.0906;%%
  %19 citations counted in INSPIRE as of 12 Oct 2013

%\cite{Staub:2013tta}
\bibitem{Staub:2013tta} 
  F.~Staub,
  %``SARAH 4: A tool for (not only SUSY) model builders,''
  arXiv:1309.7223 [hep-ph].
  %%CITATION = ARXIV:1309.7223;%%
  %2 citations counted in INSPIRE as of 12 Oct 2013

\bibitem{flexi-susy} 
P.~Athron, Jae-hyeon Park, D.~Stockinger and A.~Voigt, {\it Flexible Supersymmetry}, In development, \\
https://github.com/Expander/FlexibleSUSY

%\cite{Sper13}
\bibitem{Sper13} 
  M.~Sperling, D.~Stckinger and A.~Voigt,
  %``Renormalization of vacuum expectation values in spontaneously broken gauge theories,''
  JHEP {\bf 1307}, 132 (2013)
  [arXiv:1305.1548 [hep-ph]].
  %%CITATION = ARXIV:1305.1548;%%
  %4 citations counted in INSPIRE as of 14 Oct 2013


\end{thebibliography}

\end{document}
