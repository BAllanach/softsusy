\documentclass[final,3p,times,pdflatex]{elsarticle}
\usepackage{axodraw}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{color} % for text editing

\bibstyle{elsarticle-num}

% beginning of macros
\def\SOFTSUSY{{\tt SOFTSUSY}}
\def\code#1{\small{\tt #1}\normalsize}
\newcommand{\nn}{\nonumber}
\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\ba}{\begin{eqnarray}}
\newcommand{\ea}{\end{eqnarray}}
\newcommand{\Zv}{{\mbox{${\not\!\!Z_3}$}}}
\newcommand{\ds}{\displaystyle}
% for RGEs
\newcommand{\lamsq}{\lambda^2}
\newcommand{\kapsq}{\kappa^2}
\newcommand{\tr}{\mathrm{Tr}}
\newcommand{\dt}{\frac{d}{dt}}
\newcommand{\mhusq}{m^2_{H_2}}
\newcommand{\mhdsq}{m^2_{H_1}}
\newcommand{\mlamsq}{M_\lambda^2}
\newcommand{\mkapsq}{M_\kappa^2}
\newcommand{\mssq}{m_S^2}
\newcommand{\mtrisq}{m_3^2}
\newcommand{\msprsq}{m_S'^2}
\newcommand{\mqsq}{\textbf{m}_Q^2}
\newcommand{\mdsq}{\textbf{m}_D^2}
\newcommand{\musq}{\textbf{m}_U^2}
\newcommand{\mlsq}{\textbf{m}_L^2}
\newcommand{\mesq}{\textbf{m}_E^2}
\newcommand{\Alam}{a_\lambda/\lambda}
\newcommand{\Akap}{a_\kappa/\kappa}
\newcommand{\Musq}{M_u^2}
\newcommand{\Mdsq}{M_d^2}
\newcommand{\Mesq}{M_e^2}
% end of macros

\journal{Computer Physics Communications}

\begin{document}

\begin{frontmatter}

\title{Next-to-Minimal SOFTSUSY}

\author{B.C.~Allanach}
\address{DAMTP, CMS, University of Cambridge, Wilberforce road, Cambridge, CB3
  0WA, United Kingdom}

\author{P.~Athron}
\author{Lewis~C.~Tunstall}
\author{A.G.~Williams}
\address{ARC Centre of Excellence for Particle Physics at 
the Tera-scale, School of Chemistry and Physics, University of Adelaide, 
Adelaide SA 5005 Australia}

\author{A.~Voigt}
\address{Institut f\"ur Kern- und Teilchenphysik,
TU Dresden, Zellescher Weg 19, 01069 Dresden, Germany}
\begin{abstract}
  Here, we describe an extension to the
  {\tt SOFTSUSY}~program to calculate the sparticle spectrum in the
  {\em next-to-minimal} supersymmetric standard model, where a chiral
  superfield that is a singlet of the Standard Model gauge group is added to
  the minimal supersymmetric standard model fields. 
  The user provides a theoretical boundary condition upon the couplings and
  masses of the singlet.
  Successful radiative electroweak symmetry breaking,
  electroweak and CKM matrix data are used
  as weak-scale boundary conditions. 
  The renormalisation group equations are solved
  numerically between the weak scale and a high energy scale using a nested
  iterative algorithm. 
  This paper serves as a manual to the
  next-to-minimal mode of the program, detailing the approximations and
  conventions used. 
\end{abstract}

\begin{keyword}
sparticle, 
NMSSM, Higgs
\PACS 12.60.Jv
\PACS 14.80.Ly
\end{keyword}
\end{frontmatter}

\section{Program Summary}
\noindent{\em Program title:} \SOFTSUSY{}\\
{\em Program obtainable
  from:} {\tt http://projects.hepforge.org/softsusy/}\\
{\em Distribution format:}\/ tar.gz\\
{\em Programming language:} {\tt C++}, {\tt fortran}\\
{\em Computer:}\/ Personal computer\\
{\em Operating system:}\/ Tested on Linux 4.x\\
{\em Word size:}\/ 32 bits\\
{\em External routines:}\/ None\\
{\em Typical running time:}\/ a few seconds per parameter point.\\
{\em Nature of problem:}\/ Calculating supersymmetric particle spectrum and
mixing parameters in the next-to-minimal minimal supersymmetric standard
model. The solution to the renormalisation group equations must be consistent
with boundary conditions on supersymmetry breaking parameters, as
well as a weak-scale boundary condition on gauge 
couplings, Yukawa couplings and the Higgs potential parameters.\\
{\em Solution method:}\/ Nested iterative algorithm and numerical minimisation
of the Higgs potential. \\
{\em Restrictions:} {\SOFTSUSY} will provide a solution only in the
perturbative r\'{e}gime and it
assumes that all couplings of the model are real
(i.e.\ $CP-$conserving). The iterative \SOFTSUSY~algorithm will not 
converge if parameters are too close to a boundary of successful electroweak
symmetry breaking, but a warning flag will alert the user to this fact.

\newpage

\section{Introduction}

Recently, an apparently Standard Model Higgs boson was discovered in the CMS
and ATLAS experiments at over the 5$-\sigma$ level~\cite{}. 

\section{NMSSM Parameters \label{sec:notation}}

In this section, we introduce the NMSSM parameters
in the \SOFTSUSY~conventions. The translations to the actual variable
names that are being used in the program code are shown explicitly in
~\ref{sec:objects}. 



\subsection{Supersymmetric parameters \label{susypars}}
The chiral superfield particle content of the NMSSM has the 
following $SU(3)_c\times SU(2)_L\times U(1)_Y$ quantum numbers:
\begin{eqnarray}
\hat{L}:&(1,2,-\frac{1}{2}),\quad \hat{{\bar E}}:&(1,1,1),\qquad\, \hat{Q}:\,(3,2,\frac{1}{6}),\quad
\hat{{\bar U}}:\,(\bar 3,1,-\frac{2}{3}),\nonumber\\ \hat{{\bar D}}:&(\bar 3,1,\frac{1}{3}),\quad
\hat{H}_1:&(1,2,-\frac{1}{2}),\quad \hat{H}_2:\,(1,2,\frac{1}{2}),\quad \hat{S}:\,(1,1,0)
\label{fields}
\end{eqnarray}
$\hat S$ is the Higgs singlet that is particular to the NMSSM.
$\hat L$, $\hat Q$, $\hat H_1$, and $\hat H_2$ are the left handed doublet lepton and
quark superfields and the two Higgs doublets. $\hat{\bar E}$, $\hat{\bar U}$, and
$\hat{\bar D}$ are the lepton, up-type quark and down-type quark
right-handed superfield singlets, respectively. 
Note that the lepton
doublet superfields $\hat{L}^a_i$ and the Higgs doublet superfield coupling
to the down-type quarks, $\hat{H}_1$, have the same SM gauge 
quantum numbers. 
Here, we denote an $SU(3)$ colour index of the fundamental
representation by  $\{x,y,z\} \in \{1,2,3 \}$. The $SU(2)_L$ fundamental
representation indices are denoted by $\{a,b,c\} \in \{1,2\}$ and the generation
indices by $\{i,j,k\} \in \{1,2,3\}$. 
$\epsilon_{xyz}=\epsilon^{xyz}$ and  $\epsilon_{ab}=\epsilon^{ab}$ are totally
antisymmetric tensors, with $\epsilon_{123}=1$ and $\epsilon_{12}=1$,
respectively.  Currently, only real couplings in the superpotential and Lagrangian are included. 

The full renormalisable, $R-$parity conserving superpotential is given by,
\ba 
 W_{\Zv}  &=&  \epsilon_{ab} \left[ (Y_E)_{ij} \hat L_i^b
\hat H_1^a \hat{\bar E}_j + (Y_D)_{ij} \hat Q_i^{bx} \hat H_1^a \hat{\bar D}_{jx} +
(Y_U)_{ij} \hat Q_i^{ax} \hat H_2^b \hat{\bar U}_{jx} 
+(\lambda \hat{S} + \mu)(\hat{H}^a_2 \hat{H}^b_1) \right ] +\frac{1}{3}\kappa\hat{S}^3 + \zeta_F\hat{S} + \frac{1}{2} \mu^\prime\hat{S}^2 \\
 &=& W_{MSSM}^{\mu =0}  +  \epsilon_{ab}\left [(\lambda \hat{S} + \mu)(\hat{H}^a_2 \hat{H}^b_1) \right ]+\frac{1}{3}\kappa\hat{S}^3 + \zeta_F\hat{S} + \frac{1}{2} \mu^\prime\hat{S}^2. 
\label{eq:WZ3V}
\ea
 
\noindent where we have used the subscript \Zv to reflect that this superpotential contains terms which violate the $Z_3$ symmetry which is imposed on the NMSSM in it's most common form.  Imposing the $Z_3$ symmetry restricts the superpotential to,

\ba 
 W_{Z_3} &=& \epsilon_{ab} \left[ (Y_E)_{ij} \hat L_i^b
\hat H_1^a \hat{\bar E}_j + (Y_D)_{ij} \hat Q_i^{bx} \hat H_1^a \hat{\bar D}_{jx} +
(Y_U)_{ij} \hat Q_i^{ax} \hat H_2^b \hat{\bar U}_{jx}  
+\lambda \hat{S}(\hat{H}^a_2 \hat{H}^b_1) \right ]+\frac{1}{3}\kappa\hat{S}^3 \\
 &=& W_{MSSM}^{\mu =0}  + \epsilon_{ab} \lambda \hat{S} (\hat{H}^a_2 \hat{H}^b_1) +\frac{1}{3}\kappa\hat{S}^3.
\label{eq:WZ3C}
\ea


\noindent The $Z_3$ NMSSM superpotential contains no explicit mass parameter, thereby allowing a solution to the $\mu$-problem when the singlet field picks up a VEV and generates an effective $\mu$ term of the right size.   As such it is sometimes referred to as the scale invariant NMSSM in the literature.  Here we will always write $Z_3$-NMSSM for the $Z_3$ conserving case and \Zv-NMSSM for the general $Z_3$ violating one. 


\subsection{Next-to-Minimal SUSY breaking parameters \label{sec:susybreak}}
The soft breaking scalar potential is given by,

\be V_{soft} = V_3 + V^{m_3^2 = 0}_2 + m_S^2|S|^2 + \epsilon_{ab} a_\lambda S H^a_2 H^b_1 + \frac{1}{3} a_\kappa S^3 + V_\Zv \ee where all \Zv terms are included in,
\ba V_\Zv & = & \frac{1}{2}m_S^{\prime \, 2} S^2 + \xi_S S + \epsilon_{ab} m_3^2 H_2^a H_1^b + \textrm{H.c.} \ea while $V_3$ and $V_2$ are the trilinear scalar interaction potential and scalar bilinear SUSY breaking potential of the MSSM, given in the original SOFTSUSY manual for the $R$-parity conserving MSSM\cite{Allanach:2001kg}.   The superscript on $V^{m_3^2 = 0}_2$ indicates that the \Zv soft bilinear mass $m_3^2$ present in $V_2$ is set to zero so that it is not double counted. 

%% \be V_{soft} = V_3 + V_2 + V_\Zv \ee where
%% \ba V_3 & = & V^{MSSM}_3 + \epsilon_{ab} a_\lambda S H^a_2 H^b_1 + \frac{1}{3} a_\kappa S^3 \\
%% V_2  & = & V^{MSSM}_2 + m_S^2|S|^2  \\
%% V_\Zv & = & \frac{1}{2}m_S^{\prime \, 2} S^2 + \xi_S S + \textrm{H.c.} \ea
%% \noindent and in the case of $Z_3$ conservation the soft potential reduces to,
%% \be V_{soft} = V_3 + V^{m_3^2 = 0}_2 \ee with the superscript indicationg that the \Zv soft bilinear mass $m_3^2$ present in $V^{MSSM}_2$ is set to zero.    

\subsection{Higgs potential and EWSB\label{sec:hpot}}
The tree level Higgs potential is given by,
\ba V_{Higgs} & = & V^H_F + V^H_D + V_{\rm soft}^H  \\
            & = & V^{\mu=0}_{MSSM} + V^{HN}_{F} + V_{\rm soft}^{HN}\ea where 
\ba  V^{HN}_{F} & = &  |\lambda S + \mu|^2 (|H_2|^2+|H_1|^2) + |\lambda H_2H_1
+\kappa S^2 + \mu^\prime S + \xi_S|^2  , \label{eq:HpotF} \\
 V_{\rm soft}^{HN}  & = &  m_S^2|S|^2
+ [\lambda A_{\lambda}SH_2H_1+\frac{1}{3}\kappa A_{\kappa}S^3+ \ds\frac{1}{2}m_S^{\prime \, 2} S^2 + \xi_S S + \textrm{H.c.} ], 
\label{eq:HpotS} \ea

The three neutral Higgs fields then pick up vacuum expectation values,  
\be 
        \langle H_1 \rangle = \ds\frac{1}{\sqrt{2}}{v_1 \choose 0}, 
\qquad  \langle H_2 \rangle = \ds\frac{1}{\sqrt{2}}{0 \choose v_2}, 
\qquad  \langle S \rangle =  \ds\frac{1}{\sqrt{2}}s, \label{eq:potmin} \ee
  
\noindent and the minimisation conditions relate the VEVs to the soft masses,
\ba m_{H_1}^2&=& -\frac{1}{2}M_Z^2 \cos(2\beta) - \ds\frac{1}{2}\lambda^2 v_2^2
 + (m_3^2)_\textrm{eff} \tan\beta 
- |\mu_\textrm{eff}|^2, \label{eq:mind}\\
m_{H_2}^2&=& \frac{1}{2}M_Z^2 \cos(2\beta) - \ds\frac{1}{2}\lambda^2 v_1^2 
+  \frac{(m_3^2)_\textrm{eff}}{\tan\beta} 
- |\mu_\textrm{eff}|^2 , \label{eq:minu} \\
m_S^2 &=& -\kappa^2 s^2 - \ds\frac{1}{2}\lambda^2v^2 + \kappa\lambda v_2v_1
+ \lambda A_{\lambda} \frac{v_2v_1}{\sqrt{2}s}
-\kappa A_{\kappa}s  - m^{\prime \,2}_S - \mu^{\prime \,2} + 2 \kappa \xi_F  - 3 \kappa s \mu^\prime \label{eq:mins}
\ea where $\tan \beta = v_2 /  v_1$. %% $\bar g = \sqrt{g^2+g^{\prime 2}}$ and $g$ and $g^{\prime}$
%% are the gauge couplings of $SU(2)_L$ and $U(1)$ interactions
%% respectively, with $g = g_2$ and $g^\prime = \sqrt{3/5} \, g_1$.
For simplicity we have introduced,
\be (m_3^2)_\textrm{eff} = \ds\frac{ \lambda s}{\sqrt{2}} B_\textrm{eff} + \widehat{m}_3^2 \ee and
\be  \mu_\textrm{eff} = \mu + \lambda \frac{s}{\sqrt{2}} \;\;\;\; B_\textrm{eff}\equiv A_\lambda+\ds\frac{\kappa s}{\sqrt{2}} \;\;\;\; \widehat{m}_3^2 = m_3^2 + \lambda (\ds\frac{\mu^\prime s}{\sqrt{2}} + \xi_F) \ee



%% Eq.(\ref{eq:mind}, \ref{eq:minu}) can be rewritten as
%% \begin{eqnarray}
%% 	\mu_\textrm{eff}^2&=&\frac{\overline{m}_{H_1}^2-\overline{m}_{H_2}^2t^2}{t^2-1}-\frac{1}{2}\overline{M}_z^2,\label{nmssm_mu}\\
%% 	 (m_3^2)_\textrm{eff}&=&\frac{1}{2}\sin{2\beta}\left(\overline{m}_{H_2}^2+\overline{m}_{H_1}^2+ 2\mu_\textrm{eff}^2\left(1+\frac{\overline{M}_z^2}{\overline{g}^2s^2}\right)\right)\label{nmssm_bmu}
%% \end{eqnarray}
%% with  and we have also defined, 
%% \ba \overline{m}^2_{H_1} &=&  m^2_{H_1} - \frac{1}{v_1}\frac{\partial \Delta V}{\partial v_1}, \quad
%%  \overline{m}^2_{H_2} =  m^2_{H_2} - \frac{1}{v_2}\frac{\partial \Delta V}{\partial v_2}, \quad
%% \overline{M}_Z^2 = M_Z^2 + {\mathcal Re}\Pi_{ZZ}^T. \ea.
 

\subsection{Tree-level masses \label{sec:tree}}
The chargino and sfermion masses are given by the same expressions as in the MSSM with $\mu \rightarrow \mu_\textrm{eff}$. 

The Lagrangian contains the neutralino mass matrix as
$-\frac{1}{2}
{\tilde\psi^0}{}^T{\cal M}_{\tilde\psi^0}\tilde\psi^0$ + h.c., where
$\tilde\psi^0 =$ $(-i\tilde b,$ $-i\tilde w^3,$ $\tilde h_1,$ $\tilde
h_2, \tilde{s})^T$ and
%The Neutralinos mass matrix is, 
\begin{equation}
{\cal M}_{\tilde\psi^0} \ =\ \left(\begin{array}{ccccc} 
M_1 & 0 &-M_Zc_\beta s_W & M_Zs_\beta s_W & 0 \\
 0 & M_2 & M_Zc_\beta c_W & -M_Zs_\beta c_W & 0 \\ 
-M_Zc_\beta s_W & M_Zc_\beta c_W & 0 & -\mu & -\lambda v_2 \\
M_Zs_\beta s_W & -M_Zs_\beta c_W & -\mu & 0 & - \lambda v_1 \\
0 & 0 & 0 & 0 & 2 \kappa s + \mu^\prime
\end{array} \right). \label{mchi0}
\end{equation} 
We use $s$ and $c$ for sine and cosine, so that
$s_\beta\equiv\sin\beta,\ c_{\beta}\equiv\cos\beta$ and $s_W (c_W)$ is
the sine (cosine) of the weak mixing angle.  

The 5 by 5 neutralino mixing matrix is an orthogonal matrix $O$ with real
entries,  such that $O^T {\cal M}_{\tilde\psi^0} O$ is diagonal.
The neutralinos $\chi^0_i$ are defined such that their absolute masses
increase with increasing $i$. Some of their mass values can be negative. 

The CP-even gauge eigenstates $(H^0)^T = (H_1^0,\, H_2^0, \, S)$ are rotated into mass eigenstates by,
\be h^0 = R H^0, \ee with the mass matrix appearing in the Lagrangian as  $-(H^0)^T M_H^0 H^0$ and is given by,
\be
M_{H^0}^2=
\left(
\begin{array}{ccc}
\ds\frac{\partial^2 V}{\partial^2 v_1 } - \ds\frac{1}{v_1}\frac{\partial V}{\partial v_1}&
\ds\frac{\partial^2 V}{\partial v_1 \partial v_2}&
\ds\frac{\partial^2 V}{\partial v_1 \partial s}\\[0.3cm]
\ds\frac{\partial^2 V}{\partial v_2 \partial v_1}&
\ds\frac{\partial^2 V}{\partial^2 v_2} - \ds\frac{1}{v_2}\frac{\partial V}{\partial v_2}&
\ds\frac{\partial^2 V}{\partial v_2 \partial s}\\[0.3cm]
\ds\frac{\partial^2 V}{\partial s \partial v_1}&
\ds\frac{\partial^2 V}{\partial s \partial v_2}&
\ds\frac{\partial^2 V}{\partial^2 s} - \ds\frac{1}{s}\frac{\partial V}{\partial s},
\end{array} 
\right)
 \ee where we have rewritten the elements of $M_{H^0}^2$ by imposing tree level EWSB substitution on the the double derivatives of the effective potential, which is equivalent to defining,  \be(M_{H^0}^2)_{ij} \equiv  \ds\frac{\partial^2 V}{\partial v_i \partial v_j} - \ds\frac{\delta_{ij}}{v_i}\ds\frac{\partial V}{\partial v_i}, \ee with $v_3 \equiv s$.  The elements are then given as follows,   

\ba
 (M_{H^0}^2)_{11} & = & M_Z^2 c_\beta^2 + (\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2)\,\tan\beta,\\
 (M_{H^0}^2)_{12} & = & (4\lambda^2 - \bar{g}^2) \ds\frac{v_2 v_1 }{4}- 
\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} - \widehat{m}_3^2, \\ 
 (M_{H^0}^2)_{13} & = & \lambda (2 \mu_\textrm{eff}\,\ds\frac{ v_1}{\sqrt{2}} -
(B_\textrm{eff} + \kappa s + \mu')\ds\frac{ v_2}{\sqrt{2}}),\\
 (M_{H^0}^2)_{22} & = & M_Z^2 s_\beta^2 + (\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2)/\tan\beta\, \\
 (M_{H^0}^2)_{23} & = & \lambda (2 \mu_\textrm{eff}\, \ds\frac{ v_2}{\sqrt{2}} -
(B_\textrm{eff} + \frac{\kappa s}{\sqrt{2}} + \mu')\ds\frac{ v_1}{\sqrt{2}}), \\
 (M_{H^0}^2)_{33} & = & \ds\frac{1}{\sqrt{2}}\lambda (A_\lambda + \mu') \frac{v_2 v_1}{s}
+ \frac{\kappa s}{\sqrt{2}} (A_\kappa + 4\frac{\kappa s}{\sqrt{2}}+ 3 \mu') - \sqrt{2}(\xi_S + \xi_F \mu')/s.
\label{eq:MH0}
\ea

The three imaginary components of the neutral Higgs fields $(H^I)^T = (H^I_1, H_2^I, S^I)$ mix to give the two physical CP odd bosons and the Goldstone boson, $a^T = (G^0, A_1, A_2)$, with the two bases related by,
 \be a = P H^I \ee where $P$ matches the conventions of \cite{Degrassi:2009yq} and stripping the first row from $P$ leaves the 2 by 3 mixing matrix for the physical CP-odd Higgs bosons in SLHA2 conventions\cite{Allanach:2008qq}. Following the review of Ellwanger et al \cite{Ellwanger:2009dp} we write the entries of the 3 by 3 mass matrix in the $H^I$ basis, $ M^{\prime \, 2}_{P}$, after imposing tree level EWSB as,
\ba
( M^{\prime \, 2}_{P})_{11} & = & (\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2)\,\tan\beta , \\
( M^{\prime \, 2}_{P})_{12} & = & \ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2, \\
( M^{\prime \, 2}_{P})_{13} & = & \lambda v_u (A_\lambda - 2\kappa s - \mu'), \\
( M^{\prime \, 2}_{P})_{22} & = & (\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2)/\tan\beta ,  \\
( M^{\prime \, 2}_{P})_{23} & = & \lambda v_d (A_\lambda - 2\kappa s - \mu')\\
( M^{\prime \, 2}_{P})_{33} & = & \lambda (B_\textrm{eff}+3\kappa s +\mu')\ds\frac{v_u
v_d}{s} -3\kappa A_\kappa s  -2 m_{S}'^2 -\kappa \mu' s 
-\xi_F\left(4\kappa + \frac{\mu'}{s}\right) -\ds\frac{\xi_S}{s}.
\label{eq:MA0}
\ea

Note that the mixing of the Goldstone boson, $G^0$ only depends on $\tan\beta$, as in the MSSM, as can be seen by first rotating by $\beta$, leaving a 2 by 2 block diagonal which may then be diagonalised as is shown in \cite{Ellwanger:2009dp}.  Therefore the CP-odd mixing can be stored as a single mixing angle $\theta_{HP}$ which SOFTSUSY does internally in the sPhysical object.


The charged Higgs fields in mass basis give one massless charged Goldstone boson, $G^+$ and a charged Higgs, $H^\pm$, with mass,
\be m_{H^\pm}^2 = \left(\ds\frac{\lambda s}{\sqrt{2}} B_\textrm{eff} +
\widehat{m}_3^2\right)(\tan \beta + \cot \beta) + M_W^2 - \ds\frac{\lambda^2 v^2}{2},\qquad. \ee
  
\section{Calculation Algorithm \label{sec:calculation}}


\begin{figure}
\begin{center}
\begin{picture}(323,245)
\put(10,0){\makebox(280,10)[c]{\fbox{7.\ Calculate Higgs and
      sparticle pole masses. Run to $M_Z$.}}}
\put(10,40){\makebox(280,10)[c]{\fbox{6.\ Run to $M_Z$.}}}
\put(150,76.5){\vector(0,-1){23}}
\put(10,80){\makebox(280,10)[c]{\fbox{5.\ Run to $M_X$. Apply soft breaking
and NMSSM SUSY boundary conditions.}}}
\put(150,116.5){\vector(0,-1){23}}
\put(10,120){\makebox(280,10)[c]{\fbox{4.\ EWSB, iterative solution of $\mu$ and sneutrino VEVs.}}}
\put(150,156){\vector(0,-1){23}}
\put(10,160){\makebox(280,10)[c]{\fbox{3.\ Run to $M_S$.}}}
\put(30,170){convergence}
\DashLine(115,165)(0,165){5}
\DashLine(0,165)(0,5){5}
\DashLine(0,5)(30,5){5}
\put(30,5){\vector(1,0){2}}
\put(150,197){\vector(0,-1){24}}
\put(150,239){\vector(0,-1){26}}
\put(60,245){\fbox{1.\ SUSY radiative corrections to
$g_i(M_Z)$}}
\put(10,200){\makebox(280,10)[c]{\fbox{2.\ $Y_E$, $Y_D$ include $v_k$
      contributions. Iterative solution of $Y_E$.}}} 
\put(182,45){\line(1,0){161}}
\put(343,45){\line(0,1){200}}
\put(343,245){\vector(-1,0){115}}
\end{picture}
\end{center}
\caption{Iterative algorithm used to calculate the NMSSM spectrum. 
The initial step is the
uppermost one. $M_S$ is the scale at which the EWSB
conditions 
are imposed, as discussed in the text. $M_X$ is the scale at which the high
energy SUSY breaking boundary conditions are imposed.
\label{fig:algorithm}}
\end{figure}


\subsection{Running of NMSSM couplings~\label{running}}
Herein, we follow the conventions laid out in the SOFTSUSY manual for the MSSM.  hence those adopted by Martin and Vaughn (MV) \cite{MV94}.  There is one important difference: with respect to the MV notation, the Yukawas couplings $Y_{U,D,E}$ and SUSY breaking trilinears $U_A,D_A,E_A$ are {\it transposed}, as in the {\tt SOFTSUSY} code. The complete set of two-loop renormalization group equations (RGEs) for the parameters of the MSSM can be found in \cite{MV94,Yam94}.  For the NMSSM, \cite{Ellwanger:2009dp} (EHT) list the two-loop RGEs in the third generation approximation, where the results for the soft SUSY-breaking terms (and others) originate from \cite{Ell08}.

For $t = \ln Q$, the evolution of the Yukawa couplings is given by the general expression
%
\begin{equation}
\dt Y^{ijk} = Y^{ijp}\Gamma_p^k + Y^{kjp}\Gamma_p^i + Y^{ikp}\Gamma_p^j\,,
\end{equation}
%
where 
%
\begin{equation}
\Gamma_i^j = \frac{1}{16\pi^2}\gamma_i^{(1)j} 
+ \frac{1}{(16\pi^2)^2}\gamma_{i}^{(2)j}\,,
\end{equation}
%
and the one- and two-loop anomalous dimensions $\gamma_i^j$ are
%
\begin{align}
\gamma_i^{(1)j} =& \tfrac{1}{2}Y_{ipq}Y^{jpq} - 2\delta_i^j \sum_a g_a^2C_a(i)\,, \\
%
\gamma_i^{(2)j} =& -\tfrac{1}{2}Y_{imn}Y^{npq}Y_{pqr}Y^{mrj} 
+ Y_{ipq}Y^{ipq} \sum_a g_a^2[2C_a(p) - C_a(i)] \notag \\
%
&+ 2\delta_i^j \sum_a g_a^2 
\Big[g_a^2C_a(i)S_a(R) +2\sum_b g_b^2C_a(i)C_b(i) - 3g_a^2C_a(i)C(G_a)\Big]\,.
\end{align}
%
Here $C_a(k)$ is the quadratic Casimir invariant for superfield $\Phi_k$, with 
an complex conjugation on the Yukawa couplings with downstairs indices 
understood: $Y_{ijk} \equiv Y_{ijk}^*$.  Note that the Yukawa and trilinear 
couplings are written with the same ordering as the superpotential, e.g. for 
$k = H_2$ we get
%
\begin{equation}
\dt (Y_U)^{ij} = (Y_U)^{ij}\Gamma^{H_2}_{H_2} + (Y_U)^{jp}\Gamma_{Q_p}^{Q_i} + (Y_U)^{ip}\Gamma_{U_p}^{U_j}\,.
\end{equation}

\subsubsection{Gauge Couplings}
In the NMSSM, the one-loop RGEs of the for the gauge couplings $g_a$ are 
identical to those for the MSSM.  At two-loop order however, the $\lambda$ 
coupling appears through the term
%
\begin{equation}
\dt g_a \ni - \frac{g_a^3}{(16\pi^2)^2} Y_{ijk}Y^{ijk} C_a(k)/d(G_a)\,,  
\end{equation}
%
where $d(G_a)$ is the dimension of the adjoint representation of gauge group 
$G_a$.  To obtain a non-zero contribution from $\lambda$, $k\neq S_k$ (since 
$C_a(S)=0$) and furthermore $C_3(H_k)=0$. The explicit expression reads
%
\begin{align}
\left. Y_{ijk}Y^{ijk}\right|_\lambda &= Y_{SH_1H_2}Y^{SH_1H_2} 
+ Y_{H_1SH_2}Y^{H_1SH_2} + (H_1 \leftrightarrow H_2) \notag \\
%
&= 8\lambda^2\,,
\label{eqn:yuk S}\end{align}
%
where we have taken into account an additional factor of 2 which arises from 
tracing over $SU(2)$.  By weighing each term with the appropriate $C_a(k)$ 
factors, we get\footnote{Watch out for differing normalizations of $g_1$.  
EHT present their results with the Standard Model normalization, while 
\cite{MV94} (and hence this work) adopt a GUT scale normalization: 
$(g_1^{SM})^2 = \tfrac{3}{5}(g_1^{GUT})^2$.}
%
\begin{equation}
\left. \dt g_a\right|_\lambda = -\frac{g_a^3}{(16\pi^2)^2}\lamsq \Lambda_a^{(2)}\,,
\qquad \Lambda_a^{(2)} = (\tfrac{6}{5},2,0)\,.
\end{equation}

\subsubsection{Gaugino Mass Parameters}
As for the gauge couplings above, we only need to consider the addition of the 
$\lambda^2$ terms arising from
%
\begin{equation}
\dt M_a \ni \frac{2g_a^2}{(16\pi^2)^2} 
\frac{(U^{ijk} - M_a Y^{ijk}) Y_{ijk}C_a(k)}{d(G_a)}\,,
\end{equation}
%
where $U^{ijk}$ is the trilinear soft SUSY-breaking parameter.  For the 
$\lambda^2$ contribution, we only need to consider the soft term
%
\begin{equation}
-\mathcal{L}_{\mathrm{soft}} \ni a_\lambda H_2\cdot H_1 S\,,
\end{equation}
%
For the soft contribution we find
%
\begin{align}
\left. U^{ijk}Y_{ijk}\right|_{\lambda} &= U^{SH_2H_1}Y_{SH_2H1} 
+ U^{H_2SH_1}Y_{H_2SH_1} + (H_1 \leftrightarrow H_2) \notag \\
%
&= 8\lambda a_\lambda\,,
\end{align}
%
with the Yukawa sum given by Eq.~(\ref{eqn:yuk S}).  By combining these results 
we obtain
%
\begin{equation}
\left. \dt M_a\right|_{\lambda} = \frac{2g_a^2}{(16\pi^2)^2} 
(\lambda a_\lambda - \lambda^2 M_a)\Lambda^{(2)}_a\,.
\end{equation}

\subsubsection{Yukawa Couplings}
At one-loop, the only modification to the MSSM results \cite{MV94,Yam94} for 
$Y_\alpha$ is the inclusion of $\lamsq$ terms which originate from the Higgs 
anomalous dimensions
%
\begin{align}
\left.\gamma^{(1) H_1}_{H_1}\right|_\lambda = \lamsq\,, 
\quad \mbox{and} \quad \left.\gamma^{(1) H_2}_{H_2} \right|_\lambda = \lamsq\,.
\end{align}
%
At two-loop, all the gauge-Yukawa contributions from $\lambda$ cancel for each 
$\gamma_i^j$, and so the only new contributions arising from the NMSSM are
%
\begin{align}
\left.\gamma_{L_i}^{(2)L_j}\right|_\lambda &= -\lamsq (Y_E Y_E^\dagger)_i^j\,, \\
%
\left.\gamma_{E_i}^{(2)E_j}\right|_\lambda &= -2\lamsq (Y_E^\dagger Y_E)_i^j\,, \\
%
\left.\gamma_{Q_i}^{(2)Q_j}\right|_\lambda &= -\lamsq (Y_U Y_U^\dagger)_i^j 
- \lamsq (Y_D Y_D^\dagger)_i^j\,, \\
%
\left.\gamma_{D_i}^{(2)D_j}\right|_\lambda &= -2\lamsq (Y_D^\dagger Y_D)_i^j\,, \\
%
\left.\gamma_{U_i}^{(2)U_j}\right|_\lambda &= -2\lamsq (Y_U^\dagger Y_U)_i^j \,, \\
%
\left.\gamma_{H_1}^{(2)H_1}\right|_\lambda &= -3\lambda^4 -2\lamsq\kapsq 
- 3\lamsq \tr(Y_U Y_U^\dagger)\,, \\
%
\left.\gamma_{H_2}^{(2)H_2}\right|_\lambda &= -3\lambda^4 -2\lamsq\kapsq 
- 3\lamsq \tr(Y_D Y_D^\dagger) - \lamsq \tr(Y_E Y_E^\dagger)\,.
\end{align}
%

For the NMSSM Yuwaka couplings $\lambda$ and $\kappa$, the RGEs read
%
\begin{align}
\dt\lambda &= \lambda (\Gamma^{H_1}_{H_1} + \Gamma^{H_2}_{H_2} + \Gamma^S_S)\,, \\
%
\dt\kappa &= \kappa 3\Gamma_S^S\,,
\end{align}
%
with the one- and two-loop expressions for the singlet anomalous dimension 
given by
%
\begin{align}
\gamma_S^{(1)S} &= 2\lamsq + 2\kapsq\,,\\
%
\gamma_S^{(2)S} &= -4\lambda^4 - 8\kappa^4 - 8 \kapsq\lamsq 
- 6\lamsq \tr(Y_UY_U^\dagger) - 6\lamsq \tr(Y_UY_U^\dagger) 
- 2\lamsq \tr(Y_EY_E^\dagger) + \tfrac{6}{5}g_1^2\lamsq + 6g_2^2\lamsq\,.
\end{align} 

\subsubsection{Trilinear Couplings}
In the notation of MV, the trilinear couplings $U^{ijk}$ evolve under 
%
\begin{equation}
\dt U^{ijk} = \frac{1}{16\pi^2} \left[\beta_U^{(1)}\right]^{ijk} 
+ \frac{1}{(16\pi^2)^2} \left[\beta_U^{(2)}\right]^{ijk}\,,
\end{equation}
%
where the expressions for the $\beta$ functions can be found in \cite{MV94}.  
For $x = u,d,e$ the $\lambda$ contribution to the one-loop $\beta$ function 
arises from the following factor
%
\begin{equation}
\left[\beta_{U_x}^{(1)}\right]^{ij} \ni \tfrac{1}{2} (U_x)^{ij} 
Y_{H_\alpha mn}Y^{mnH_\alpha} + (Y_x)^{ij} Y_{H_\alpha mn}U^{mnH_\alpha}\,,
\end{equation}
%
where there is {\it no summation} over $\alpha = 1,2$, with the index 
determined by the choice of $x$ (e.g.\ if $x=u$ then $\alpha = 2$). Expanding 
the indices leads to
%
\begin{equation}
\left.\left[\beta_{U_x}^{(1)}\right]^{ij}\right|_\lambda = (U_x)^{ij}\lambda^2 
+ (Y_x)^{ij} 2\lambda a_\lambda\,. \label{eqn: beta hx}
\end{equation}
%

The two-loop expressions involve a large number of summations, so we choose to 
express our results in terms of $3\times 3$ matrices:
%
\begin{align}
\left.\beta_{ U_A}^{(2)}\right|_\lambda =& -\lamsq U_A\big[ 3\lamsq + 2\kapsq 
+ 3\tr( Y_D Y_D^\dagger) + \tr( Y_E Y_E^\dagger) \big] 
-\lamsq\big[ 5 Y_U Y_U^\dagger U_A + 4 U_A Y_U^\dagger Y_U +  Y_D Y_D^\dagger U_A 
+ 2 D_A Y_D^\dagger Y_U \big] \notag \\
%
&-2\lambda  a_\lambda Y_U\big[ 3\lamsq + 2\kapsq + 3\tr( Y_D Y_D^\dagger) 
+ \tr( Y_E Y_E^\dagger) \big] -2\lamsq Y_U\big[ 3\lambda  a_\lambda 
+ 2\kappa a_\kappa + 3\tr( D_A Y_D^\dagger) + \tr( E_A Y_E^\dagger) \big] \notag \\
%
&-2\lambda  a_\lambda\big[ 3 Y_U Y_U^\dagger Y_U +  Y_D Y_D^\dagger Y_U \big]\,, \\
%
%
\left.\beta_{ D_A}^{(2)}\right|_\lambda =& -\lamsq D_A\big[ 3\lamsq + 2\kapsq 
+ 3\tr( Y_U Y_U^\dagger) \big] 
-\lamsq\big[ 5 Y_D Y_D^\dagger D_A + 4 D_A Y_D^\dagger Y_D + 2 U_A Y_U^\dagger Y_D 
+  Y_U Y_U^\dagger D_A \big] \notag \\
%
&-2\lambda  a_\lambda  Y_D\big[ 3\lamsq + 2\kapsq + 3\tr( Y_U Y_U^\dagger) \big]
-2\lamsq Y_D\big[ 3\lambda  a_\lambda + 2\kappa a_\kappa 
+ 3\tr( U_A Y_U^\dagger) \big] -2\lambda  a_\lambda\big[ 3 Y_D Y_D^\dagger Y_D 
+  Y_U Y_U^\dagger Y_D\big]\,,  \\
%
%
\left.\beta_{ E_A}^{(2)}\right|_\lambda =& -\lamsq  E_A\big[ 3\lamsq + 2\kapsq 
+ 3\tr( Y_U Y_U^\dagger) \big] 
-\lamsq\big[ 5 Y_E Y_E^\dagger E_A + 4 E_A Y_E^\dagger Y_E \big] 
-2\lambda  a_\lambda  Y_E\big[ 3\lamsq + 2\kapsq + 3\tr( Y_U Y_U^\dagger) \notag \\
%
&-2\lamsq Y_E\big[ 3\lambda a_\lambda + 2\kappa a_\kappa + 3\tr( U_A Y_U^\dagger) 
\big] -6\lambda a_\lambda  Y_E Y_E^\dagger Y_E\,.
\end{align}

For $a_\lambda$, the one-loop $\beta$ function reads in full
%
\begin{align}
\beta_{a_\lambda}^{(1)} =&\, \tfrac{1}{2}a_\lambda (Y_{H_1mn}Y^{mnH_1} + Y_{H_2mn}Y^{mnH_2}
 + Y_{Smn}Y^{mnS}) + \lambda (Y_{H_1mn}U^{mnH_1} + Y_{H_2mn}U^{mnH_2} 
+ Y_{Smn}U^{mnS}) \notag \\
%
&- 4\sum_{a=1,2,3} (a_\lambda - 2M_a\lambda)g_a^2C_a(H)\,.
\end{align}
%
The various sums yield
%
\begin{align}
Y_{H_1mn}Y^{mnH_1} &= 6\tr( Y_D  Y_D^\dagger) + 2\tr( Y_E  Y_E^\dagger) + 2\lamsq\,, \\
%
Y_{H_2mn}Y^{mnH_2} &= 6\tr( Y_U  Y_U^\dagger) + 2\lamsq\,, \label{eqn:YH2sq} \\
%
Y_{Smn}Y^{mnS} &= 4\lamsq + 4\kapsq\,, \\
%
Y_{H_1mn}U^{mnH_1} &= 6\tr( D_A  Y_D^\dagger) + 2\tr( E_A  Y_E^\dagger) 
+ 2a_\lambda\lambda\,, \\
%
Y_{H_2mn}U^{mnH_2} &= 6\tr( U_A  Y_U^\dagger) + 2a_\lambda\lambda\,, \\
%
Y_{Smn}U^{mnS} &= 4a_\lambda\lambda + 4a_\kappa\kappa\,,
\end{align}
%
and putting it all together:
%
\begin{align}
\beta_{a_\lambda}^{(1)} =&\, a_\lambda[3\tr( Y_U  Y_U^\dagger) + 3\tr( Y_D  Y_D^\dagger) 
+ \tr( Y_E  Y_E^\dagger) + 12\lamsq + 2\kapsq - \tfrac{3}{5}g_1^2 - 3g_2^2] 
\notag \\
%
&+ \lambda[6\tr( U_A  Y_U^\dagger) + 6\tr( D_A  Y_D^\dagger) + 2\tr( E_A  Y_E^\dagger)
+ 4a_\kappa\kappa + \tfrac{6}{5}g_1^2M_1 + 6g_2^2M_2]\,.
\end{align}
%
The two-loop expression is:
\begin{align}
\beta_{a_\lambda}^{(2)} =&-50\lambda^4 a_\lambda 
- 36\lambda\tr(U_A Y_U^\dagger Y_U Y_U^\dagger) 
- 36\lambda\tr(D_A Y_D^\dagger Y_D Y_D^\dagger)
- 12\lambda\tr(E_A Y_E^\dagger Y_E Y_E^\dagger) 
- 9a_\lambda\tr( Y_U Y_U^\dagger Y_U Y_U^\dagger) \notag \\
%
&- 9a_\lambda\tr( Y_D Y_D^\dagger Y_D Y_D^\dagger) 
- 3a_\lambda\tr( Y_E Y_E^\dagger Y_E Y_E^\dagger) - 8\kappa^4 a_\lambda 
- 32\lambda\kappa^3 h_\kappa - 12\lamsq\kapsq a_\lambda \notag \\
%
&-18\lambda^3\big[ (\Alam)\tr( Y_U Y_U^\dagger) + \tr(U_A Y_U^\dagger)\big] 
- 18\lambda^3\big[(\Alam)\tr( Y_D Y_D^\dagger) + \tr(D_A Y_D^\dagger)\big] \notag \\
%
&-6\lambda^3\big[(\Alam)\tr( Y_E Y_E^\dagger) + \tr(E_A Y_E^\dagger)\big] 
-24\lambda^3\kapsq\big[ (\Alam) + (\Akap)\big]
-12\lambda\big[ \tr(U_A Y_U^\dagger Y_D Y_D^\dagger) 
+ \tr(D_A Y_D^\dagger Y_U Y_U^\dagger) \big] \notag \\
%
&-3\lamsq a_\lambda\big[ 3\tr( Y_U Y_U^\dagger) + 3\tr( Y_D Y_D^\dagger) 
+ \tr( Y_E Y_E^\dagger) \big] -6a_\lambda\tr( Y_U Y_U^\dagger Y_D Y_D^\dagger) 
+ \tfrac{12}{5}g_1^2\lamsq\big[ \tfrac{3}{2}a_\lambda - \lambda M_1\big] \notag \\
%
&+\tfrac{8}{5}g_1^2\lambda\big[ \tr(U_A Y_U^\dagger) - M_1\tr( Y_U Y_U^\dagger) \big]
-\tfrac{4}{5}g_1^2\lambda\big[ \tr(D_A Y_D^\dagger) - M_1\tr( Y_D Y_D^\dagger)\big] 
+\tfrac{12}{5}g_1^2\lambda\big[\tr(E_A Y_E^\dagger) - M_1\tr( Y_E Y_E^\dagger)\big] 
\notag \\
%
&+\tfrac{2}{5}g_1^2 a_\lambda\big[ 2\tr( Y_U Y_U^\dagger) - \tr( Y_D Y_D^\dagger) 
+ 3\tr( Y_E Y_e^\dagger) \big] + 12g_2^2\lamsq\big[ \tfrac{3}{2}a_\lambda 
- \lambda M_2\big] \notag \\
%
&+32g_3^2\lambda\big[ \tr(U_A Y_U^\dagger) - M_3\tr( Y_U Y_U^\dagger) \big]
+32g_3^2\lambda\big[\tr(D_A Y_D^\dagger) - M_3\tr( Y_D Y_D^\dagger) \big] 
+ 16g_3^2 a_\lambda\big[ \tr( Y_U Y_U^\dagger) + \tr( Y_D Y_D^\dagger) \big] \notag \\
%
&+ \tfrac{1}{50}g_1^4\lambda\big[ 207(\Alam) - 828M_1\big] 
+ \tfrac{1}{2}g_2^4\lambda\big[ 15(\Alam) - 60M_2\big]
+\tfrac{9}{5}g_1^2 g_2^2\lambda\big[ (\Alam) - 2(M_1 + M_2)\big] \,.
\end{align}

For $a_\kappa$, the one-loop calculation is similar to that of $a_\lambda$, with 
the result
%
\begin{equation}
\beta_{a_\kappa}^{(1)} = 18a_\kappa\kappa^2 + 12a_\lambda\kappa\lambda 
+ 6a_\kappa\lamsq\,.
\end{equation}
%
At two-loop we have
%
\begin{align}
\beta_{a_\kappa}^{2)} =& -120\kappa^4 a_\kappa - 12\lambda^4 a_\kappa 
- 48\lambda^3\kappa a_\lambda - 48\lamsq\kappa^3\big[ (\Alam) + (\Akap)\big]
-24\lamsq\kapsq a_\kappa \notag \\
%
&-36\lamsq\kappa\big[ \tr( U_A Y_u^\dagger) + (\Alam)\tr( Y_u Y_u^\dagger)\big]
-36\lamsq\kappa\big[ \tr( D_A Y_d^\dagger) + (\Alam)\tr( Y_d Y_d^\dagger)\big] 
\notag \\
%
&-12\lamsq\kappa\big[ \tr( E_A Y_e^\dagger) + (\Alam)\tr( Y_e Y_e^\dagger)\big]
-6\lamsq a_\kappa\big[ 3\tr( Y_u Y_u^\dagger) + 3\tr( Y_d Y_d^\dagger) 
+ \tr( Y_e Y_e^\dagger) \big] \notag \\
%
&+ \tfrac{36}{5}g_1^2\lamsq\kappa\big[ (\Alam) + \tfrac{1}{2}(\Akap) - M_1\big] 
+ 36g_2^2\lamsq \kappa\big[ (\Alam) + \tfrac{1}{2}(\Akap) - M_2 \big]\,.
\end{align}

\textcolor{red}{--- LCT: Up to here ---}

The program 
can be made to run faster by switching off the two-loop renormalisation of 
the scalar masses and tri-linear scalar couplings. All
$\beta$ functions are real and include inter-generational quark mixing
effects. 

\subsection{Electroweak symmetry breaking \label{ewsb}}


\subsection{NMSSM spectrum \label{spec}}



\section*{Acknowledgments}
This work has been partially supported by 
STFC\@. 


\appendix

\section{Running \SOFTSUSY}
\label{sec:run}

\SOFTSUSY~produces an executable called \code{softpoint.x}. For the calculation
of the spectrum of single points in parameter space, we recommend the
SUSY Les Houches Accord 2 (SLHA2)~\cite{Allanach:2008qq}  input/output
option. The user must provide a file (\textit{e.g.} the example file included
in the \SOFTSUSY~distribution
\code{rpvHouchesInput}), that specifies the model dependent input
parameters. The program may then be run with
\small
\begin{verbatim}
 ./softpoint.x leshouches < nmssmHouchesInput
\end{verbatim}
\normalsize
For the SLHA2 input option, 
the output will also be given in 
SLHA2 format. Such output can be used for
input into other programs which subscribe to the accord, such as
\code{PYTHIA}~\cite{Sjostrand:2007gs} (for
simulating sparticle production and decays at colliders), for example. For
further details on the necessary format of 
the input file, see ref.~\cite{Allanach:2008qq}. It supports 
the setting of all other SLHA2 input blocks associated with non-complex
couplings. 

$M_{GUT}$ is used (defined to be the $\overline{DR}$ scale $Q$ at which $g_1(Q) =
g_2(Q)$). The default output is in SLHA2 format, the conventions of which are
explained in Ref.~\cite{Allanach:2008qq}. 


\section{Class Structure\label{sec:objects}}

We now go on to sketch the NMSSM class hierarchy.  Only methods and
data which are deemed of possible importance for prospective users are
mentioned here, but there are many others within the program itself.


\subsection{General structure}

\begin{figure}
  \begin{center}
    \begin{picture}(200,200)
      \GBox(200,200)(0,0){0.9}
      \ArrowLine(100,180)(100,150)
      \ArrowLine(100,150)(100,110)
      \ArrowLine(100,110)(100,60)
      \SetPFont{Teletype}{10}
      \put(0,0){\framebox(200,200){}}
      \BText(100,180){RGE}
      \BText(100,150){MssmSusy}
      \B2Text(100,110){SoftPars<MssmSusy>}{= SoftParsMssm}
      \B2Text(100,60){Softsusy<SoftParsMssm>}{= MssmSoftsusy}
    \end{picture}\hfill
    \begin{picture}(200,200)
      \GBox(200,200)(0,0){0.9}
      \ArrowLine(100,175)(100,150)
      \ArrowLine(100,150)(100,125)
      \ArrowLine(100,125)(100,100)
      \ArrowLine(100,100)(100,75)
      \ArrowLine(100,75)(100,50)
      \ArrowLine(100,50)(100,25)
      \SetPFont{Teletype}{10}
      \put(0,0){\framebox(200,200){}}
      \BText(100,175){RGE}
      \BText(100,150){MssmSusy}
      \BText(100,125){NmssmSusy}
      \BText(100,100){SoftPars<NmssmSusy>}
      \BText(100,75){SoftParsNmssm}
      \BText(100,50){Softsusy<SoftParsNmssm>}
      \BText(100,25){NmssmSoftsusy}
    \end{picture}
    \caption{\label{fig:objstruc} Heuristic high-level class
      structure of \SOFTSUSY\@. Inheritance is displayed by the
      arrows and typedefs are displayed by the equals signs.}
  \end{center}
\end{figure}

To implement the NMSSM (and other non-minimal supersymmetric models),
the \SOFTSUSY\ class hierarchy was generalized with the following
requirements in mind:
%
\begin{itemize}
\item The class of supersymmetric parameters (gauge couplings,
  superpotential parameters and VEVs), whose beta functions are
  independent of soft-breaking parameters, should be at the top of the
  class hierarchy.  This makes them usable independently of the
  soft-breaking parameters, for example during the initial guess.

\item One should be able to reuse as much MSSM code as possible, for
  example by inheriting from existing MSSM classes.
\end{itemize}

The above requirements were implemented by the following changes:
%
\begin{enumerate}
\item The class of the soft breaking MSSM parameters and their beta
  functions was converted into the class template \code{SoftPars<Susy>}.
  The template parameter represents the class of supersymmetric
  parameters, from which \code{SoftPars<Susy>} inherits.  The class
  which contains \emph{all} MSSM parameters and beta functions,
  \code{SoftParsMssm}, was made a typdef for
  \code{SoftPars<MssmSusy>}, where \code{MssmSusy} is the class that
  contains the supersymmetric MSSM parameters and beta functions.
\begin{verbatim}
template <class Susy>
class SoftPars : public Susy {
   // implementation of soft breaking MSSM parameters
   // and their beta functions
};

typedef SoftPars<MssmSusy> SoftParsMssm;
\end{verbatim}
  This approach makes it possible to have a class of soft breaking
  MSSM parameters but with a different set of supersymmetric
  parameters.  This mechanism is used in the NMSSM, see Section
  \ref{nmssmsoftpars}.

\item The class which organises the MSSM mass spectrum calculation was
  converted into the class template \code{Softsusy<SoftPars>}.  The
  template parameter represents the class of all model parameters and
  beta functions, from which \code{Softsusy<SoftPars>} inherits.
  \code{MssmSoftsusy} was made a typedef for
  \code{Softsusy<SoftParsMssm>}.
\begin{verbatim}
template <class SoftPars>
class Softsusy : public SoftPars {
   // organisation of MSSM mass spectrum calculation
   // using model parameters in SoftPars
};

typedef Softsusy<SoftParsMssm> MssmSoftsusy;
\end{verbatim}
  This approach makes it possible to have a MSSM spectrum calculation
  class but with an arbitrary set of model parameters.  This mechanism
  is used in the NMSSM, see Section \ref{nmssmsoftsusy}.
\end{enumerate}

\subsection{\code{NmssmSusy}~class}
\label{nmssmsusy}

The class of supersymmetric NMSSM parameters and beta functions,
\code{NmssmSusy}, inherits from \code{MssmSusy} to reuse the MSSM
ones, see \figurename~\ref{fig:objstruc}.

\subsection{\code{SoftParsNmssm}~class}
\label{nmssmsoftpars}

To implement the class of soft-breaking NMSSM parameters,
\code{SoftParsNmssm}, the \code{SoftPars<Susy>} template is
instantiated using \code{NmssmSusy} as template parameter.  Thereby
one obtains the class of MSSM soft-breaking beta functions, using
supersymmetric NMSSM parameters.  \code{SoftParsNmssm} then inherits
from \code{SoftPars<NmssmSusy>} to add extra NMSSM contributions to
the soft-breaking beta functions:
%
\begin{verbatim}
class NmssmSusy : public MssmSusy {
   // implement supersymmetric NMSSM parameter beta functions
   // by reusing MSSM ones
};

class SoftParsNmssm : public SoftPars<NmssmSusy> {
   // implement soft-breaking NMSSM parameter beta functions
   // by reusing MSSM ones
};
\end{verbatim}

\subsection{\code{NmssmSoftsusy}~class}
\label{nmssmsoftsusy}

To create the NMSSM spectrum calculation class, \code{NmssmSoftsusy},
the \code{Softsusy<SoftPars>} template class is instantiated using
\code{SoftParsNmssm} as template parameter.  Thereby one obtains a
MSSM spectrum calculator, which uses NMSSM parameters and beta
functions.  \code{NmssmSoftsusy} then inherits from
\code{Softsusy<SoftParsNmssm>} and overwrites MSSM functions to
account for the extra NMSSM particles:
%
\begin{verbatim}
class NmssmSoftsusy : public Softsusy<SoftParsNmssm> {
   // organise NMSSM spectrum calculation reusing MSSM functions
};
\end{verbatim}


\begin{thebibliography}{10}
%\cite{Allanach:2001kg}
\bibitem{Allanach:2001kg} 
  B.~C.~Allanach,
  %``SOFTSUSY: a program for calculating supersymmetric spectra,''
  Comput.\ Phys.\ Commun.\  {\bf 143}, 305 (2002)
  [hep-ph/0104145].
  %%CITATION = HEP-PH/0104145;%%
  %716 citations counted in INSPIRE as of 20 Sep 2013

%\cite{Degrassi:2009yq}
\bibitem{Degrassi:2009yq} 
  G.~Degrassi and P.~Slavich,
  %``On the radiative corrections to the neutral Higgs boson masses in the NMSSM,''
  Nucl.\ Phys.\ B {\bf 825}, 119 (2010)
  [arXiv:0907.4682 [hep-ph]].
  %%CITATION = ARXIV:0907.4682;%%
  %35 citations counted in INSPIRE as of 21 Sep 2013
%\cite{Allanach:2008qq}
\bibitem{Allanach:2008qq} 
  B.~C.~Allanach, C.~Balazs, G.~Belanger, M.~Bernhardt, F.~Boudjema, D.~Choudhury, K.~Desch and U.~Ellwanger {\it et al.},
  %``SUSY Les Houches Accord 2,''
  Comput.\ Phys.\ Commun.\  {\bf 180}, 8 (2009)
  [arXiv:0801.0045 [hep-ph]].
  %%CITATION = ARXIV:0801.0045;%%
  %177 citations counted in INSPIRE as of 21 Sep 2013

%\cite{Ellwanger:2009dp}
\bibitem{Ellwanger:2009dp} 
  U.~Ellwanger, C.~Hugonie and A.~M.~Teixeira,
  %``The Next-to-Minimal Supersymmetric Standard Model,''
  Phys.\ Rept.\  {\bf 496}, 1 (2010)
  [arXiv:0910.1785 [hep-ph]].
  %%CITATION = ARXIV:0910.1785;%%
  %327 citations counted in INSPIRE as of 21 Sep 2013

%\cite{MV94}
\bibitem{MV94} 
  S.~P.~Martin and M.~T.~Vaughn,
  %``Two loop renormalization group equations for soft supersymmetry breaking couplings,''
  Phys.\ Rev.\ D {\bf 50}, 2282 (1994)
  [Erratum-ibid.\ D {\bf 78}, 039903 (2008)]
  [hep-ph/9311340].
  %%CITATION = HEP-PH/9311340;%%
  %568 citations counted in INSPIRE as of 24 Sep 2013

%\cite{Yam94}
\bibitem{Yam94} 
  Y.~Yamada,
  %``Two loop renormalization group equations for soft SUSY breaking scalar interactions: Supergraph method,''
  Phys.\ Rev.\ D {\bf 50}, 3537 (1994)
  [hep-ph/9401241].
  %%CITATION = HEP-PH/9401241;%%
  %225 citations counted in INSPIRE as of 24 Sep 2013

%\cite{Ell08}
\bibitem{Ell08} 
  U.~Ellwanger, C.~-C.~Jean-Louis and A.~M.~Teixeira,
  %``Phenomenology of the General NMSSM with Gauge Mediated Supersymmetry Breaking,''
  JHEP {\bf 0805}, 044 (2008)
  [arXiv:0803.2962 [hep-ph]].
  %%CITATION = ARXIV:0803.2962;%%
  %28 citations counted in INSPIRE as of 24 Sep 2013


\end{thebibliography}

\end{document}
